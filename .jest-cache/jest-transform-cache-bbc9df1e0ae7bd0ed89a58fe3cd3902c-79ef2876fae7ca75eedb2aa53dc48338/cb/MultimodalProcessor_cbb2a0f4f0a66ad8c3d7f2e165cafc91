ff0e2b98856a0b0d84d1d1c037bb5fc9
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
/**
 * MULTIMODAL PROCESSOR
 * Processa entrada multimodal: Voz (Speech-to-Text) e Imagem (Vision)
 * Suporta: MP3, WAV, MP4, WebM, PNG, JPG, GIF, WebP
 */

class MultimodalProcessor {
  constructor() {
    this.supportedAudioFormats = ['mp3', 'wav', 'mp4', 'webm', 'ogg', 'm4a'];
    this.supportedImageFormats = ['png', 'jpg', 'jpeg', 'gif', 'webp', 'bmp'];
    this.maxAudioSize = 25 * 1024 * 1024; // 25MB
    this.maxImageSize = 20 * 1024 * 1024; // 20MB
  }

  /**
   * Processar √°udio (Speech-to-Text)
   */
  async processAudio(audioBuffer, format = 'mp3') {
    console.log(`üé§ Processando √°udio (${format})...`);

    // Validar formato
    if (!this.supportedAudioFormats.includes(format.toLowerCase())) {
      throw new Error(`Formato de √°udio n√£o suportado: ${format}`);
    }

    // Validar tamanho
    if (audioBuffer.length > this.maxAudioSize) {
      throw new Error(`Arquivo de √°udio muito grande: ${audioBuffer.length} bytes`);
    }
    try {
      // Chamar API de Speech-to-Text (Google Cloud Speech-to-Text)
      const transcript = await this.transcribeAudio(audioBuffer, format);
      console.log(`‚úÖ √Åudio transcrito: "${transcript.substring(0, 50)}..."`);
      return {
        type: 'audio',
        format,
        transcript,
        confidence: 0.95,
        // Confian√ßa estimada
        duration: await this.estimateAudioDuration(audioBuffer, format)
      };
    } catch (error) {
      throw new Error(`Erro ao processar √°udio: ${error.message}`);
    }
  }

  /**
   * Transcrever √°udio via API
   */
  async transcribeAudio(audioBuffer, format) {
    try {
      // Converter buffer para base64
      const base64Audio = audioBuffer.toString('base64');

      // Chamar API de transcription (simulado)
      // Em produ√ß√£o, usar Google Cloud Speech-to-Text ou similar

      const response = await fetch('/api/transcribe', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          audio: base64Audio,
          format,
          language: 'pt-BR'
        })
      });
      if (!response.ok) {
        throw new Error(`Erro na transcri√ß√£o: ${response.status}`);
      }
      const data = await response.json();
      return data.transcript;
    } catch (error) {
      // Fallback: retornar mensagem de erro
      throw error;
    }
  }

  /**
   * Estimar dura√ß√£o do √°udio
   */
  async estimateAudioDuration(audioBuffer, format) {
    // Estimativa simples baseada no tamanho
    // Em produ√ß√£o, usar biblioteca de √°udio
    const bitrate = 128; // kbps
    const durationSeconds = audioBuffer.length * 8 / (bitrate * 1000);
    return Math.round(durationSeconds);
  }

  /**
   * Processar imagem (Vision)
   */
  async processImage(imageBuffer, format = 'png') {
    console.log(`üì∏ Processando imagem (${format})...`);

    // Validar formato
    if (!this.supportedImageFormats.includes(format.toLowerCase())) {
      throw new Error(`Formato de imagem n√£o suportado: ${format}`);
    }

    // Validar tamanho
    if (imageBuffer.length > this.maxImageSize) {
      throw new Error(`Arquivo de imagem muito grande: ${imageBuffer.length} bytes`);
    }
    try {
      // Analisar imagem
      const analysis = await this.analyzeImage(imageBuffer, format);
      console.log(`‚úÖ Imagem analisada: ${analysis.description}`);
      return {
        type: 'image',
        format,
        analysis,
        size: imageBuffer.length
      };
    } catch (error) {
      throw new Error(`Erro ao processar imagem: ${error.message}`);
    }
  }

  /**
   * Analisar imagem via API
   */
  async analyzeImage(imageBuffer, format) {
    try {
      // Converter buffer para base64
      const base64Image = imageBuffer.toString('base64');

      // Chamar API de Vision (simulado)
      // Em produ√ß√£o, usar Google Cloud Vision ou similar

      const response = await fetch('/api/vision-analyze', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          image: base64Image,
          format,
          features: ['LABEL_DETECTION', 'TEXT_DETECTION', 'OBJECT_LOCALIZATION', 'SAFE_SEARCH_DETECTION']
        })
      });
      if (!response.ok) {
        throw new Error(`Erro na an√°lise: ${response.status}`);
      }
      const data = await response.json();
      return data.analysis;
    } catch (error) {
      throw error;
    }
  }

  /**
   * Processar entrada multimodal (√°udio + imagem)
   */
  async processMultimodal(inputs) {
    console.log(`üé¨ Processando entrada multimodal...`);
    const results = {
      audio: null,
      image: null,
      combined: null
    };

    // Processar √°udio se fornecido
    if (inputs.audio) {
      results.audio = await this.processAudio(inputs.audio.buffer, inputs.audio.format);
    }

    // Processar imagem se fornecida
    if (inputs.image) {
      results.image = await this.processImage(inputs.image.buffer, inputs.image.format);
    }

    // Combinar resultados
    if (results.audio && results.image) {
      results.combined = this.combineResults(results.audio, results.image);
    }
    return results;
  }

  /**
   * Combinar resultados de √°udio e imagem
   */
  combineResults(audioResult, imageResult) {
    return {
      transcript: audioResult.transcript,
      imageAnalysis: imageResult.analysis,
      combinedContext: `√Åudio: "${audioResult.transcript}"\n\nImagem: ${imageResult.analysis.description}`,
      confidence: {
        audio: audioResult.confidence,
        image: imageResult.analysis.confidence || 0.9
      }
    };
  }

  /**
   * Extrair texto de imagem (OCR)
   */
  async extractTextFromImage(imageBuffer, format = 'png') {
    console.log(`üìÑ Extraindo texto da imagem...`);
    const analysis = await this.analyzeImage(imageBuffer, format);
    if (analysis.textDetection && analysis.textDetection.length > 0) {
      const extractedText = analysis.textDetection.map(item => item.text).join('\n');
      return {
        success: true,
        text: extractedText,
        confidence: analysis.textDetection[0].confidence || 0.9
      };
    }
    return {
      success: false,
      text: '',
      message: 'Nenhum texto encontrado na imagem'
    };
  }

  /**
   * Descrever imagem
   */
  async describeImage(imageBuffer, format = 'png') {
    console.log(`üì∏ Descrevendo imagem...`);
    const analysis = await this.analyzeImage(imageBuffer, format);
    return {
      description: analysis.description,
      labels: analysis.labels || [],
      objects: analysis.objects || [],
      confidence: analysis.confidence || 0.9
    };
  }

  /**
   * Detectar c√≥digo em imagem
   */
  async detectCodeInImage(imageBuffer, format = 'png') {
    console.log(`üíª Detectando c√≥digo na imagem...`);
    const textResult = await this.extractTextFromImage(imageBuffer, format);
    if (!textResult.success) {
      return {
        success: false,
        code: '',
        language: null
      };
    }

    // Detectar linguagem de programa√ß√£o
    const language = this.detectProgrammingLanguage(textResult.text);
    return {
      success: true,
      code: textResult.text,
      language,
      confidence: textResult.confidence
    };
  }

  /**
   * Detectar linguagem de programa√ß√£o
   */
  detectProgrammingLanguage(code) {
    const patterns = {
      'javascript': /const|let|var|function|=>|async|await/,
      'python': /def|import|class|if __name__|print\(/,
      'java': /public class|public static|import java/,
      'cpp': /#include|std::|int main/,
      'csharp': /using|namespace|public class|async Task/,
      'go': /package main|func|import/,
      'rust': /fn |let |pub |impl /,
      'sql': /SELECT|INSERT|UPDATE|DELETE|FROM|WHERE/,
      'html': /<!DOCTYPE|<html|<body|<div/,
      'css': /@media|\.class|#id|{.*:.*;}/
    };
    for (const [lang, pattern] of Object.entries(patterns)) {
      if (pattern.test(code)) {
        return lang;
      }
    }
    return null;
  }

  /**
   * Validar arquivo de √°udio
   */
  validateAudioFile(filename, size) {
    const ext = filename.split('.').pop().toLowerCase();
    if (!this.supportedAudioFormats.includes(ext)) {
      return {
        valid: false,
        error: `Formato n√£o suportado: ${ext}`
      };
    }
    if (size > this.maxAudioSize) {
      return {
        valid: false,
        error: `Arquivo muito grande: ${size} bytes (m√°ximo: ${this.maxAudioSize})`
      };
    }
    return {
      valid: true
    };
  }

  /**
   * Validar arquivo de imagem
   */
  validateImageFile(filename, size) {
    const ext = filename.split('.').pop().toLowerCase();
    if (!this.supportedImageFormats.includes(ext)) {
      return {
        valid: false,
        error: `Formato n√£o suportado: ${ext}`
      };
    }
    if (size > this.maxImageSize) {
      return {
        valid: false,
        error: `Arquivo muito grande: ${size} bytes (m√°ximo: ${this.maxImageSize})`
      };
    }
    return {
      valid: true
    };
  }

  /**
   * Obter informa√ß√µes de suporte
   */
  getSupportInfo() {
    return {
      audio: {
        formats: this.supportedAudioFormats,
        maxSize: this.maxAudioSize,
        features: ['Speech-to-Text', 'Transcription', 'Language Detection']
      },
      image: {
        formats: this.supportedImageFormats,
        maxSize: this.maxImageSize,
        features: ['OCR', 'Object Detection', 'Label Detection', 'Code Detection']
      }
    };
  }
}
var _default = exports.default = MultimodalProcessor;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNdWx0aW1vZGFsUHJvY2Vzc29yIiwiY29uc3RydWN0b3IiLCJzdXBwb3J0ZWRBdWRpb0Zvcm1hdHMiLCJzdXBwb3J0ZWRJbWFnZUZvcm1hdHMiLCJtYXhBdWRpb1NpemUiLCJtYXhJbWFnZVNpemUiLCJwcm9jZXNzQXVkaW8iLCJhdWRpb0J1ZmZlciIsImZvcm1hdCIsImNvbnNvbGUiLCJsb2ciLCJpbmNsdWRlcyIsInRvTG93ZXJDYXNlIiwiRXJyb3IiLCJsZW5ndGgiLCJ0cmFuc2NyaXB0IiwidHJhbnNjcmliZUF1ZGlvIiwic3Vic3RyaW5nIiwidHlwZSIsImNvbmZpZGVuY2UiLCJkdXJhdGlvbiIsImVzdGltYXRlQXVkaW9EdXJhdGlvbiIsImVycm9yIiwibWVzc2FnZSIsImJhc2U2NEF1ZGlvIiwidG9TdHJpbmciLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXVkaW8iLCJsYW5ndWFnZSIsIm9rIiwic3RhdHVzIiwiZGF0YSIsImpzb24iLCJiaXRyYXRlIiwiZHVyYXRpb25TZWNvbmRzIiwiTWF0aCIsInJvdW5kIiwicHJvY2Vzc0ltYWdlIiwiaW1hZ2VCdWZmZXIiLCJhbmFseXNpcyIsImFuYWx5emVJbWFnZSIsImRlc2NyaXB0aW9uIiwic2l6ZSIsImJhc2U2NEltYWdlIiwiaW1hZ2UiLCJmZWF0dXJlcyIsInByb2Nlc3NNdWx0aW1vZGFsIiwiaW5wdXRzIiwicmVzdWx0cyIsImNvbWJpbmVkIiwiYnVmZmVyIiwiY29tYmluZVJlc3VsdHMiLCJhdWRpb1Jlc3VsdCIsImltYWdlUmVzdWx0IiwiaW1hZ2VBbmFseXNpcyIsImNvbWJpbmVkQ29udGV4dCIsImV4dHJhY3RUZXh0RnJvbUltYWdlIiwidGV4dERldGVjdGlvbiIsImV4dHJhY3RlZFRleHQiLCJtYXAiLCJpdGVtIiwidGV4dCIsImpvaW4iLCJzdWNjZXNzIiwiZGVzY3JpYmVJbWFnZSIsImxhYmVscyIsIm9iamVjdHMiLCJkZXRlY3RDb2RlSW5JbWFnZSIsInRleHRSZXN1bHQiLCJjb2RlIiwiZGV0ZWN0UHJvZ3JhbW1pbmdMYW5ndWFnZSIsInBhdHRlcm5zIiwibGFuZyIsInBhdHRlcm4iLCJPYmplY3QiLCJlbnRyaWVzIiwidGVzdCIsInZhbGlkYXRlQXVkaW9GaWxlIiwiZmlsZW5hbWUiLCJleHQiLCJzcGxpdCIsInBvcCIsInZhbGlkIiwidmFsaWRhdGVJbWFnZUZpbGUiLCJnZXRTdXBwb3J0SW5mbyIsImZvcm1hdHMiLCJtYXhTaXplIiwiX2RlZmF1bHQiLCJleHBvcnRzIiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbIk11bHRpbW9kYWxQcm9jZXNzb3IuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBNVUxUSU1PREFMIFBST0NFU1NPUlxuICogUHJvY2Vzc2EgZW50cmFkYSBtdWx0aW1vZGFsOiBWb3ogKFNwZWVjaC10by1UZXh0KSBlIEltYWdlbSAoVmlzaW9uKVxuICogU3Vwb3J0YTogTVAzLCBXQVYsIE1QNCwgV2ViTSwgUE5HLCBKUEcsIEdJRiwgV2ViUFxuICovXG5cbmNsYXNzIE11bHRpbW9kYWxQcm9jZXNzb3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnN1cHBvcnRlZEF1ZGlvRm9ybWF0cyA9IFsnbXAzJywgJ3dhdicsICdtcDQnLCAnd2VibScsICdvZ2cnLCAnbTRhJ107XG4gICAgdGhpcy5zdXBwb3J0ZWRJbWFnZUZvcm1hdHMgPSBbJ3BuZycsICdqcGcnLCAnanBlZycsICdnaWYnLCAnd2VicCcsICdibXAnXTtcbiAgICB0aGlzLm1heEF1ZGlvU2l6ZSA9IDI1ICogMTAyNCAqIDEwMjQ7IC8vIDI1TUJcbiAgICB0aGlzLm1heEltYWdlU2l6ZSA9IDIwICogMTAyNCAqIDEwMjQ7IC8vIDIwTUJcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzYXIgw6F1ZGlvIChTcGVlY2gtdG8tVGV4dClcbiAgICovXG4gIGFzeW5jIHByb2Nlc3NBdWRpbyhhdWRpb0J1ZmZlciwgZm9ybWF0ID0gJ21wMycpIHtcbiAgICBjb25zb2xlLmxvZyhg8J+OpCBQcm9jZXNzYW5kbyDDoXVkaW8gKCR7Zm9ybWF0fSkuLi5gKTtcblxuICAgIC8vIFZhbGlkYXIgZm9ybWF0b1xuICAgIGlmICghdGhpcy5zdXBwb3J0ZWRBdWRpb0Zvcm1hdHMuaW5jbHVkZXMoZm9ybWF0LnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZvcm1hdG8gZGUgw6F1ZGlvIG7Do28gc3Vwb3J0YWRvOiAke2Zvcm1hdH1gKTtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGFyIHRhbWFuaG9cbiAgICBpZiAoYXVkaW9CdWZmZXIubGVuZ3RoID4gdGhpcy5tYXhBdWRpb1NpemUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQXJxdWl2byBkZSDDoXVkaW8gbXVpdG8gZ3JhbmRlOiAke2F1ZGlvQnVmZmVyLmxlbmd0aH0gYnl0ZXNgKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgLy8gQ2hhbWFyIEFQSSBkZSBTcGVlY2gtdG8tVGV4dCAoR29vZ2xlIENsb3VkIFNwZWVjaC10by1UZXh0KVxuICAgICAgY29uc3QgdHJhbnNjcmlwdCA9IGF3YWl0IHRoaXMudHJhbnNjcmliZUF1ZGlvKGF1ZGlvQnVmZmVyLCBmb3JtYXQpO1xuXG4gICAgICBjb25zb2xlLmxvZyhg4pyFIMOBdWRpbyB0cmFuc2NyaXRvOiBcIiR7dHJhbnNjcmlwdC5zdWJzdHJpbmcoMCwgNTApfS4uLlwiYCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdhdWRpbycsXG4gICAgICAgIGZvcm1hdCxcbiAgICAgICAgdHJhbnNjcmlwdCxcbiAgICAgICAgY29uZmlkZW5jZTogMC45NSwgLy8gQ29uZmlhbsOnYSBlc3RpbWFkYVxuICAgICAgICBkdXJhdGlvbjogYXdhaXQgdGhpcy5lc3RpbWF0ZUF1ZGlvRHVyYXRpb24oYXVkaW9CdWZmZXIsIGZvcm1hdCksXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gcHJvY2Vzc2FyIMOhdWRpbzogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUcmFuc2NyZXZlciDDoXVkaW8gdmlhIEFQSVxuICAgKi9cbiAgYXN5bmMgdHJhbnNjcmliZUF1ZGlvKGF1ZGlvQnVmZmVyLCBmb3JtYXQpIHtcbiAgICB0cnkge1xuICAgICAgLy8gQ29udmVydGVyIGJ1ZmZlciBwYXJhIGJhc2U2NFxuICAgICAgY29uc3QgYmFzZTY0QXVkaW8gPSBhdWRpb0J1ZmZlci50b1N0cmluZygnYmFzZTY0Jyk7XG5cbiAgICAgIC8vIENoYW1hciBBUEkgZGUgdHJhbnNjcmlwdGlvbiAoc2ltdWxhZG8pXG4gICAgICAvLyBFbSBwcm9kdcOnw6NvLCB1c2FyIEdvb2dsZSBDbG91ZCBTcGVlY2gtdG8tVGV4dCBvdSBzaW1pbGFyXG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvdHJhbnNjcmliZScsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgYXVkaW86IGJhc2U2NEF1ZGlvLFxuICAgICAgICAgIGZvcm1hdCxcbiAgICAgICAgICBsYW5ndWFnZTogJ3B0LUJSJyxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gbmEgdHJhbnNjcmnDp8OjbzogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICByZXR1cm4gZGF0YS50cmFuc2NyaXB0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBGYWxsYmFjazogcmV0b3JuYXIgbWVuc2FnZW0gZGUgZXJyb1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEVzdGltYXIgZHVyYcOnw6NvIGRvIMOhdWRpb1xuICAgKi9cbiAgYXN5bmMgZXN0aW1hdGVBdWRpb0R1cmF0aW9uKGF1ZGlvQnVmZmVyLCBmb3JtYXQpIHtcbiAgICAvLyBFc3RpbWF0aXZhIHNpbXBsZXMgYmFzZWFkYSBubyB0YW1hbmhvXG4gICAgLy8gRW0gcHJvZHXDp8OjbywgdXNhciBiaWJsaW90ZWNhIGRlIMOhdWRpb1xuICAgIGNvbnN0IGJpdHJhdGUgPSAxMjg7IC8vIGticHNcbiAgICBjb25zdCBkdXJhdGlvblNlY29uZHMgPSAoYXVkaW9CdWZmZXIubGVuZ3RoICogOCkgLyAoYml0cmF0ZSAqIDEwMDApO1xuICAgIHJldHVybiBNYXRoLnJvdW5kKGR1cmF0aW9uU2Vjb25kcyk7XG4gIH1cblxuICAvKipcbiAgICogUHJvY2Vzc2FyIGltYWdlbSAoVmlzaW9uKVxuICAgKi9cbiAgYXN5bmMgcHJvY2Vzc0ltYWdlKGltYWdlQnVmZmVyLCBmb3JtYXQgPSAncG5nJykge1xuICAgIGNvbnNvbGUubG9nKGDwn5O4IFByb2Nlc3NhbmRvIGltYWdlbSAoJHtmb3JtYXR9KS4uLmApO1xuXG4gICAgLy8gVmFsaWRhciBmb3JtYXRvXG4gICAgaWYgKCF0aGlzLnN1cHBvcnRlZEltYWdlRm9ybWF0cy5pbmNsdWRlcyhmb3JtYXQudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRm9ybWF0byBkZSBpbWFnZW0gbsOjbyBzdXBvcnRhZG86ICR7Zm9ybWF0fWApO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXIgdGFtYW5ob1xuICAgIGlmIChpbWFnZUJ1ZmZlci5sZW5ndGggPiB0aGlzLm1heEltYWdlU2l6ZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBcnF1aXZvIGRlIGltYWdlbSBtdWl0byBncmFuZGU6ICR7aW1hZ2VCdWZmZXIubGVuZ3RofSBieXRlc2ApO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBBbmFsaXNhciBpbWFnZW1cbiAgICAgIGNvbnN0IGFuYWx5c2lzID0gYXdhaXQgdGhpcy5hbmFseXplSW1hZ2UoaW1hZ2VCdWZmZXIsIGZvcm1hdCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGDinIUgSW1hZ2VtIGFuYWxpc2FkYTogJHthbmFseXNpcy5kZXNjcmlwdGlvbn1gKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ2ltYWdlJyxcbiAgICAgICAgZm9ybWF0LFxuICAgICAgICBhbmFseXNpcyxcbiAgICAgICAgc2l6ZTogaW1hZ2VCdWZmZXIubGVuZ3RoLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIHByb2Nlc3NhciBpbWFnZW06ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQW5hbGlzYXIgaW1hZ2VtIHZpYSBBUElcbiAgICovXG4gIGFzeW5jIGFuYWx5emVJbWFnZShpbWFnZUJ1ZmZlciwgZm9ybWF0KSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENvbnZlcnRlciBidWZmZXIgcGFyYSBiYXNlNjRcbiAgICAgIGNvbnN0IGJhc2U2NEltYWdlID0gaW1hZ2VCdWZmZXIudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuXG4gICAgICAvLyBDaGFtYXIgQVBJIGRlIFZpc2lvbiAoc2ltdWxhZG8pXG4gICAgICAvLyBFbSBwcm9kdcOnw6NvLCB1c2FyIEdvb2dsZSBDbG91ZCBWaXNpb24gb3Ugc2ltaWxhclxuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL3Zpc2lvbi1hbmFseXplJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBpbWFnZTogYmFzZTY0SW1hZ2UsXG4gICAgICAgICAgZm9ybWF0LFxuICAgICAgICAgIGZlYXR1cmVzOiBbXG4gICAgICAgICAgICAnTEFCRUxfREVURUNUSU9OJyxcbiAgICAgICAgICAgICdURVhUX0RFVEVDVElPTicsXG4gICAgICAgICAgICAnT0JKRUNUX0xPQ0FMSVpBVElPTicsXG4gICAgICAgICAgICAnU0FGRV9TRUFSQ0hfREVURUNUSU9OJyxcbiAgICAgICAgICBdLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBuYSBhbsOhbGlzZTogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICByZXR1cm4gZGF0YS5hbmFseXNpcztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFByb2Nlc3NhciBlbnRyYWRhIG11bHRpbW9kYWwgKMOhdWRpbyArIGltYWdlbSlcbiAgICovXG4gIGFzeW5jIHByb2Nlc3NNdWx0aW1vZGFsKGlucHV0cykge1xuICAgIGNvbnNvbGUubG9nKGDwn46sIFByb2Nlc3NhbmRvIGVudHJhZGEgbXVsdGltb2RhbC4uLmApO1xuXG4gICAgY29uc3QgcmVzdWx0cyA9IHtcbiAgICAgIGF1ZGlvOiBudWxsLFxuICAgICAgaW1hZ2U6IG51bGwsXG4gICAgICBjb21iaW5lZDogbnVsbCxcbiAgICB9O1xuXG4gICAgLy8gUHJvY2Vzc2FyIMOhdWRpbyBzZSBmb3JuZWNpZG9cbiAgICBpZiAoaW5wdXRzLmF1ZGlvKSB7XG4gICAgICByZXN1bHRzLmF1ZGlvID0gYXdhaXQgdGhpcy5wcm9jZXNzQXVkaW8oaW5wdXRzLmF1ZGlvLmJ1ZmZlciwgaW5wdXRzLmF1ZGlvLmZvcm1hdCk7XG4gICAgfVxuXG4gICAgLy8gUHJvY2Vzc2FyIGltYWdlbSBzZSBmb3JuZWNpZGFcbiAgICBpZiAoaW5wdXRzLmltYWdlKSB7XG4gICAgICByZXN1bHRzLmltYWdlID0gYXdhaXQgdGhpcy5wcm9jZXNzSW1hZ2UoaW5wdXRzLmltYWdlLmJ1ZmZlciwgaW5wdXRzLmltYWdlLmZvcm1hdCk7XG4gICAgfVxuXG4gICAgLy8gQ29tYmluYXIgcmVzdWx0YWRvc1xuICAgIGlmIChyZXN1bHRzLmF1ZGlvICYmIHJlc3VsdHMuaW1hZ2UpIHtcbiAgICAgIHJlc3VsdHMuY29tYmluZWQgPSB0aGlzLmNvbWJpbmVSZXN1bHRzKHJlc3VsdHMuYXVkaW8sIHJlc3VsdHMuaW1hZ2UpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbWJpbmFyIHJlc3VsdGFkb3MgZGUgw6F1ZGlvIGUgaW1hZ2VtXG4gICAqL1xuICBjb21iaW5lUmVzdWx0cyhhdWRpb1Jlc3VsdCwgaW1hZ2VSZXN1bHQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHJhbnNjcmlwdDogYXVkaW9SZXN1bHQudHJhbnNjcmlwdCxcbiAgICAgIGltYWdlQW5hbHlzaXM6IGltYWdlUmVzdWx0LmFuYWx5c2lzLFxuICAgICAgY29tYmluZWRDb250ZXh0OiBgw4F1ZGlvOiBcIiR7YXVkaW9SZXN1bHQudHJhbnNjcmlwdH1cIlxcblxcbkltYWdlbTogJHtpbWFnZVJlc3VsdC5hbmFseXNpcy5kZXNjcmlwdGlvbn1gLFxuICAgICAgY29uZmlkZW5jZToge1xuICAgICAgICBhdWRpbzogYXVkaW9SZXN1bHQuY29uZmlkZW5jZSxcbiAgICAgICAgaW1hZ2U6IGltYWdlUmVzdWx0LmFuYWx5c2lzLmNvbmZpZGVuY2UgfHwgMC45LFxuICAgICAgfSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhaXIgdGV4dG8gZGUgaW1hZ2VtIChPQ1IpXG4gICAqL1xuICBhc3luYyBleHRyYWN0VGV4dEZyb21JbWFnZShpbWFnZUJ1ZmZlciwgZm9ybWF0ID0gJ3BuZycpIHtcbiAgICBjb25zb2xlLmxvZyhg8J+ThCBFeHRyYWluZG8gdGV4dG8gZGEgaW1hZ2VtLi4uYCk7XG5cbiAgICBjb25zdCBhbmFseXNpcyA9IGF3YWl0IHRoaXMuYW5hbHl6ZUltYWdlKGltYWdlQnVmZmVyLCBmb3JtYXQpO1xuXG4gICAgaWYgKGFuYWx5c2lzLnRleHREZXRlY3Rpb24gJiYgYW5hbHlzaXMudGV4dERldGVjdGlvbi5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBleHRyYWN0ZWRUZXh0ID0gYW5hbHlzaXMudGV4dERldGVjdGlvblxuICAgICAgICAubWFwKGl0ZW0gPT4gaXRlbS50ZXh0KVxuICAgICAgICAuam9pbignXFxuJyk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIHRleHQ6IGV4dHJhY3RlZFRleHQsXG4gICAgICAgIGNvbmZpZGVuY2U6IGFuYWx5c2lzLnRleHREZXRlY3Rpb25bMF0uY29uZmlkZW5jZSB8fCAwLjksXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIHRleHQ6ICcnLFxuICAgICAgbWVzc2FnZTogJ05lbmh1bSB0ZXh0byBlbmNvbnRyYWRvIG5hIGltYWdlbScsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXNjcmV2ZXIgaW1hZ2VtXG4gICAqL1xuICBhc3luYyBkZXNjcmliZUltYWdlKGltYWdlQnVmZmVyLCBmb3JtYXQgPSAncG5nJykge1xuICAgIGNvbnNvbGUubG9nKGDwn5O4IERlc2NyZXZlbmRvIGltYWdlbS4uLmApO1xuXG4gICAgY29uc3QgYW5hbHlzaXMgPSBhd2FpdCB0aGlzLmFuYWx5emVJbWFnZShpbWFnZUJ1ZmZlciwgZm9ybWF0KTtcblxuICAgIHJldHVybiB7XG4gICAgICBkZXNjcmlwdGlvbjogYW5hbHlzaXMuZGVzY3JpcHRpb24sXG4gICAgICBsYWJlbHM6IGFuYWx5c2lzLmxhYmVscyB8fCBbXSxcbiAgICAgIG9iamVjdHM6IGFuYWx5c2lzLm9iamVjdHMgfHwgW10sXG4gICAgICBjb25maWRlbmNlOiBhbmFseXNpcy5jb25maWRlbmNlIHx8IDAuOSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVjdGFyIGPDs2RpZ28gZW0gaW1hZ2VtXG4gICAqL1xuICBhc3luYyBkZXRlY3RDb2RlSW5JbWFnZShpbWFnZUJ1ZmZlciwgZm9ybWF0ID0gJ3BuZycpIHtcbiAgICBjb25zb2xlLmxvZyhg8J+SuyBEZXRlY3RhbmRvIGPDs2RpZ28gbmEgaW1hZ2VtLi4uYCk7XG5cbiAgICBjb25zdCB0ZXh0UmVzdWx0ID0gYXdhaXQgdGhpcy5leHRyYWN0VGV4dEZyb21JbWFnZShpbWFnZUJ1ZmZlciwgZm9ybWF0KTtcblxuICAgIGlmICghdGV4dFJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgY29kZTogJycsXG4gICAgICAgIGxhbmd1YWdlOiBudWxsLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBEZXRlY3RhciBsaW5ndWFnZW0gZGUgcHJvZ3JhbWHDp8Ojb1xuICAgIGNvbnN0IGxhbmd1YWdlID0gdGhpcy5kZXRlY3RQcm9ncmFtbWluZ0xhbmd1YWdlKHRleHRSZXN1bHQudGV4dCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGNvZGU6IHRleHRSZXN1bHQudGV4dCxcbiAgICAgIGxhbmd1YWdlLFxuICAgICAgY29uZmlkZW5jZTogdGV4dFJlc3VsdC5jb25maWRlbmNlLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogRGV0ZWN0YXIgbGluZ3VhZ2VtIGRlIHByb2dyYW1hw6fDo29cbiAgICovXG4gIGRldGVjdFByb2dyYW1taW5nTGFuZ3VhZ2UoY29kZSkge1xuICAgIGNvbnN0IHBhdHRlcm5zID0ge1xuICAgICAgJ2phdmFzY3JpcHQnOiAvY29uc3R8bGV0fHZhcnxmdW5jdGlvbnw9Pnxhc3luY3xhd2FpdC8sXG4gICAgICAncHl0aG9uJzogL2RlZnxpbXBvcnR8Y2xhc3N8aWYgX19uYW1lX198cHJpbnRcXCgvLFxuICAgICAgJ2phdmEnOiAvcHVibGljIGNsYXNzfHB1YmxpYyBzdGF0aWN8aW1wb3J0IGphdmEvLFxuICAgICAgJ2NwcCc6IC8jaW5jbHVkZXxzdGQ6OnxpbnQgbWFpbi8sXG4gICAgICAnY3NoYXJwJzogL3VzaW5nfG5hbWVzcGFjZXxwdWJsaWMgY2xhc3N8YXN5bmMgVGFzay8sXG4gICAgICAnZ28nOiAvcGFja2FnZSBtYWlufGZ1bmN8aW1wb3J0LyxcbiAgICAgICdydXN0JzogL2ZuIHxsZXQgfHB1YiB8aW1wbCAvLFxuICAgICAgJ3NxbCc6IC9TRUxFQ1R8SU5TRVJUfFVQREFURXxERUxFVEV8RlJPTXxXSEVSRS8sXG4gICAgICAnaHRtbCc6IC88IURPQ1RZUEV8PGh0bWx8PGJvZHl8PGRpdi8sXG4gICAgICAnY3NzJzogL0BtZWRpYXxcXC5jbGFzc3wjaWR8ey4qOi4qO30vLFxuICAgIH07XG5cbiAgICBmb3IgKGNvbnN0IFtsYW5nLCBwYXR0ZXJuXSBvZiBPYmplY3QuZW50cmllcyhwYXR0ZXJucykpIHtcbiAgICAgIGlmIChwYXR0ZXJuLnRlc3QoY29kZSkpIHtcbiAgICAgICAgcmV0dXJuIGxhbmc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhciBhcnF1aXZvIGRlIMOhdWRpb1xuICAgKi9cbiAgdmFsaWRhdGVBdWRpb0ZpbGUoZmlsZW5hbWUsIHNpemUpIHtcbiAgICBjb25zdCBleHQgPSBmaWxlbmFtZS5zcGxpdCgnLicpLnBvcCgpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkQXVkaW9Gb3JtYXRzLmluY2x1ZGVzKGV4dCkpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGBGb3JtYXRvIG7Do28gc3Vwb3J0YWRvOiAke2V4dH1gLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoc2l6ZSA+IHRoaXMubWF4QXVkaW9TaXplKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiBgQXJxdWl2byBtdWl0byBncmFuZGU6ICR7c2l6ZX0gYnl0ZXMgKG3DoXhpbW86ICR7dGhpcy5tYXhBdWRpb1NpemV9KWAsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhciBhcnF1aXZvIGRlIGltYWdlbVxuICAgKi9cbiAgdmFsaWRhdGVJbWFnZUZpbGUoZmlsZW5hbWUsIHNpemUpIHtcbiAgICBjb25zdCBleHQgPSBmaWxlbmFtZS5zcGxpdCgnLicpLnBvcCgpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkSW1hZ2VGb3JtYXRzLmluY2x1ZGVzKGV4dCkpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGBGb3JtYXRvIG7Do28gc3Vwb3J0YWRvOiAke2V4dH1gLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoc2l6ZSA+IHRoaXMubWF4SW1hZ2VTaXplKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiBgQXJxdWl2byBtdWl0byBncmFuZGU6ICR7c2l6ZX0gYnl0ZXMgKG3DoXhpbW86ICR7dGhpcy5tYXhJbWFnZVNpemV9KWAsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gIH1cblxuICAvKipcbiAgICogT2J0ZXIgaW5mb3JtYcOnw7VlcyBkZSBzdXBvcnRlXG4gICAqL1xuICBnZXRTdXBwb3J0SW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYXVkaW86IHtcbiAgICAgICAgZm9ybWF0czogdGhpcy5zdXBwb3J0ZWRBdWRpb0Zvcm1hdHMsXG4gICAgICAgIG1heFNpemU6IHRoaXMubWF4QXVkaW9TaXplLFxuICAgICAgICBmZWF0dXJlczogWydTcGVlY2gtdG8tVGV4dCcsICdUcmFuc2NyaXB0aW9uJywgJ0xhbmd1YWdlIERldGVjdGlvbiddLFxuICAgICAgfSxcbiAgICAgIGltYWdlOiB7XG4gICAgICAgIGZvcm1hdHM6IHRoaXMuc3VwcG9ydGVkSW1hZ2VGb3JtYXRzLFxuICAgICAgICBtYXhTaXplOiB0aGlzLm1heEltYWdlU2l6ZSxcbiAgICAgICAgZmVhdHVyZXM6IFsnT0NSJywgJ09iamVjdCBEZXRlY3Rpb24nLCAnTGFiZWwgRGV0ZWN0aW9uJywgJ0NvZGUgRGV0ZWN0aW9uJ10sXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTXVsdGltb2RhbFByb2Nlc3NvcjtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNQSxtQkFBbUIsQ0FBQztFQUN4QkMsV0FBV0EsQ0FBQSxFQUFHO0lBQ1osSUFBSSxDQUFDQyxxQkFBcUIsR0FBRyxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxDQUFDO0lBQ3hFLElBQUksQ0FBQ0MscUJBQXFCLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQztJQUN6RSxJQUFJLENBQUNDLFlBQVksR0FBRyxFQUFFLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDO0lBQ3RDLElBQUksQ0FBQ0MsWUFBWSxHQUFHLEVBQUUsR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLENBQUM7RUFDeEM7O0VBRUE7QUFDRjtBQUNBO0VBQ0UsTUFBTUMsWUFBWUEs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
c94a8a0f4688fe54f1375b77c08d0f5e
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _SecurityValidator = _interopRequireDefault(require("./SecurityValidator.js"));
var _AuditLogger = _interopRequireDefault(require("./AuditLogger.js"));
var _GitHubAutomation = _interopRequireDefault(require("./GitHubAutomation.js"));
var _SpecialistSelector = _interopRequireDefault(require("./SpecialistSelector.js"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
/**
 * AUTOMATION ENGINE
 * Motor central de automaÃ§Ã£o que orquestra todo o processo
 * Coordena: AnÃ¡lise â†’ SeleÃ§Ã£o de Especialista â†’ GeraÃ§Ã£o de CÃ³digo â†’ ValidaÃ§Ã£o â†’ Commit
 */

class AutomationEngine {
  constructor(config = {}) {
    this.config = {
      maxRetries: config.maxRetries || 3,
      timeout: config.timeout || 30000,
      aiModel: config.aiModel || 'gemini-2.0-flash',
      temperature: config.temperature || 0.7,
      ...config
    };
    this.validator = new _SecurityValidator.default();
    this.auditLogger = new _AuditLogger.default();
    this.specialistSelector = new _SpecialistSelector.default();

    // GitHub serÃ¡ inicializado quando necessÃ¡rio
    this.gitHub = null;
  }

  /**
   * Inicializar GitHub Automation
   */
  initializeGitHub(token) {
    try {
      this.gitHub = new _GitHubAutomation.default(token);
      return true;
    } catch (error) {
      console.error('Erro ao inicializar GitHub:', error);
      return false;
    }
  }

  /**
   * Executar automaÃ§Ã£o completa
   */
  async executeAutomation(request) {
    const automationId = this.auditLogger.logAutomationRequest({
      userId: request.userId,
      username: request.username,
      command: request.command,
      mode: request.mode || 'OPTIMIZED',
      selectedSpecialist: request.selectedSpecialist,
      description: request.description,
      ipAddress: request.ipAddress,
      userAgent: request.userAgent,
      sessionId: request.sessionId
    });
    const result = {
      automationId,
      status: 'INITIATED',
      steps: [],
      errors: []
    };
    try {
      // Fase 1: AnÃ¡lise do comando
      console.log(`\nðŸ“‹ FASE 1: AnÃ¡lise do comando`);
      const analysis = await this.analyzeCommand(request.command);
      result.steps.push({
        phase: 'ANALYSIS',
        status: 'COMPLETED',
        details: analysis
      });

      // Fase 2: SeleÃ§Ã£o de especialista
      console.log(`\nðŸŽ¯ FASE 2: SeleÃ§Ã£o de especialista`);
      let specialist;
      if (request.mode === 'HYBRID' && request.selectedSpecialist) {
        specialist = request.selectedSpecialist;
        console.log(`âœ… Especialista selecionado manualmente: ${specialist}`);
      } else {
        specialist = await this.specialistSelector.selectSpecialist(analysis.taskType, analysis.keywords);
        console.log(`âœ… Especialista selecionado automaticamente: ${specialist}`);
      }
      result.steps.push({
        phase: 'SPECIALIST_SELECTION',
        status: 'COMPLETED',
        specialist,
        mode: request.mode
      });

      // Fase 3: GeraÃ§Ã£o de cÃ³digo
      console.log(`\nðŸ’» FASE 3: GeraÃ§Ã£o de cÃ³digo`);
      const codeGeneration = await this.generateCode(analysis, specialist, request.repositoryInfo);
      result.steps.push({
        phase: 'CODE_GENERATION',
        status: 'COMPLETED',
        filesGenerated: codeGeneration.files.length,
        linesOfCode: codeGeneration.totalLines
      });

      // Fase 4: ValidaÃ§Ã£o de seguranÃ§a
      console.log(`\nðŸ” FASE 4: ValidaÃ§Ã£o de seguranÃ§a`);
      const securityValidation = await this.validateCode(codeGeneration.files);
      if (!securityValidation.isValid) {
        result.status = 'BLOCKED';
        result.errors.push({
          phase: 'SECURITY_VALIDATION',
          message: 'CÃ³digo bloqueado por validaÃ§Ã£o de seguranÃ§a',
          details: securityValidation
        });
        this.auditLogger.logSecurityValidation({
          automationId,
          filesChecked: codeGeneration.files.length,
          isValid: false,
          severity: securityValidation.severity,
          errors: securityValidation.errors,
          warnings: securityValidation.warnings
        });
        return result;
      }
      result.steps.push({
        phase: 'SECURITY_VALIDATION',
        status: 'COMPLETED',
        warnings: securityValidation.warnings.length
      });

      // Fase 5: Commit + Push
      console.log(`\nðŸ“ FASE 5: Commit + Push`);
      let commitResult = null;
      if (request.repositoryInfo && this.gitHub) {
        commitResult = await this.commitAndPush(codeGeneration.files, analysis.commitMessage, request.repositoryInfo, specialist);
        result.steps.push({
          phase: 'GIT_COMMIT',
          status: 'COMPLETED',
          commitHash: commitResult.commit.sha,
          filesChanged: commitResult.filesChanged
        });
      }

      // Fase 6: Criar PR (opcional)
      console.log(`\nðŸ”€ FASE 6: Criar Pull Request (opcional)`);
      let prResult = null;
      if (request.createPR && this.gitHub && commitResult) {
        prResult = await this.createPullRequest(analysis, specialist, request.repositoryInfo);
        result.steps.push({
          phase: 'CREATE_PR',
          status: 'COMPLETED',
          prNumber: prResult.pr.number,
          prUrl: prResult.pr.url
        });
      }

      // Sucesso!
      result.status = 'SUCCESS';
      result.output = {
        files: codeGeneration.files,
        commit: commitResult?.commit,
        pr: prResult?.pr
      };

      // Log de conclusÃ£o
      this.auditLogger.logAutomationCompletion({
        automationId,
        userId: request.userId,
        status: 'SUCCESS',
        totalDuration: result.totalDuration,
        commitHash: commitResult?.commit.sha,
        prUrl: prResult?.pr.url,
        filesCreated: codeGeneration.files.length,
        linesAdded: codeGeneration.totalLines,
        specialist,
        mode: request.mode,
        creditsUsed: request.creditsUsed
      });
      return result;
    } catch (error) {
      console.error(`âŒ Erro na automaÃ§Ã£o: ${error.message}`);
      result.status = 'FAILED';
      result.errors.push({
        message: error.message,
        stack: error.stack
      });

      // Log de erro
      this.auditLogger.logError({
        automationId,
        userId: request.userId,
        errorType: error.constructor.name,
        errorMessage: error.message,
        errorStack: error.stack,
        phase: result.steps[result.steps.length - 1]?.phase || 'UNKNOWN'
      });
      return result;
    }
  }

  /**
   * Analisar comando do usuÃ¡rio
   */
  async analyzeCommand(command) {
    // Aqui seria chamada uma IA para analisar o comando
    // Por enquanto, anÃ¡lise simples

    const keywords = command.toLowerCase().split(' ');
    let taskType = 'GENERAL';
    if (command.includes('componente') || command.includes('component')) taskType = 'COMPONENT';
    if (command.includes('funÃ§Ã£o') || command.includes('function')) taskType = 'FUNCTION';
    if (command.includes('teste') || command.includes('test')) taskType = 'TEST';
    if (command.includes('estilo') || command.includes('style')) taskType = 'STYLE';
    if (command.includes('documentaÃ§Ã£o') || command.includes('documentation')) taskType = 'DOCUMENTATION';
    if (command.includes('refator') || command.includes('refactor')) taskType = 'REFACTOR';
    return {
      command,
      taskType,
      keywords,
      commitMessage: `feat: ${command.substring(0, 50)}`,
      description: command
    };
  }

  /**
   * Gerar cÃ³digo via IA
   */
  async generateCode(analysis, specialist, repositoryInfo) {
    // Aqui seria chamada a IA (Gemini, GROQ, etc)
    // Por enquanto, simulaÃ§Ã£o

    console.log(`ðŸ¤– Gerando cÃ³digo com ${specialist}...`);

    // Simular geraÃ§Ã£o de cÃ³digo
    const files = [{
      path: `src/generated_${Date.now()}.js`,
      content: `// Gerado automaticamente por ${specialist}\n// Tarefa: ${analysis.description}\n\nexport default function generated() {\n  // CÃ³digo gerado aqui\n}\n`
    }];
    return {
      files,
      totalLines: files.reduce((sum, f) => sum + f.content.split('\n').length, 0),
      specialist
    };
  }

  /**
   * Validar cÃ³digo
   */
  async validateCode(files) {
    console.log(`ðŸ” Validando ${files.length} arquivos...`);
    const validation = await this.validator.validateFiles(files);
    if (!validation.isValid) {
      console.log(`âŒ ValidaÃ§Ã£o falhou!`);
      return {
        isValid: false,
        severity: 'critical',
        errors: validation.details.flatMap(d => d.errors),
        warnings: validation.details.flatMap(d => d.warnings)
      };
    }
    console.log(`âœ… CÃ³digo validado com sucesso!`);
    return {
      isValid: true,
      severity: 'none',
      errors: [],
      warnings: validation.details.flatMap(d => d.warnings)
    };
  }

  /**
   * Fazer commit + push
   */
  async commitAndPush(files, message, repositoryInfo, specialist) {
    console.log(`ðŸ“ Fazendo commit + push...`);
    if (!this.gitHub) {
      throw new Error('GitHub nÃ£o inicializado');
    }
    const result = await this.gitHub.commitAndPush(repositoryInfo.owner, repositoryInfo.repo, files, message, repositoryInfo.branch || 'main', {
      name: `${specialist} Bot`,
      email: `${specialist.toLowerCase()}@rkmmax.com`
    });
    console.log(`âœ… Commit realizado: ${result.commit.sha.substring(0, 7)}`);
    return result;
  }

  /**
   * Criar Pull Request
   */
  async createPullRequest(analysis, specialist, repositoryInfo) {
    console.log(`ðŸ”€ Criando Pull Request...`);
    if (!this.gitHub) {
      throw new Error('GitHub nÃ£o inicializado');
    }
    const branchName = `automation/${specialist.toLowerCase()}/${Date.now()}`;
    const pr = await this.gitHub.createPullRequest(repositoryInfo.owner, repositoryInfo.repo, `[${specialist}] ${analysis.commitMessage}`, `AutomaÃ§Ã£o executada por ${specialist}\n\nTarefa: ${analysis.description}`, branchName, repositoryInfo.branch || 'main');
    console.log(`âœ… PR criado: ${pr.url}`);
    return {
      pr
    };
  }

  /**
   * Obter histÃ³rico de automaÃ§Ãµes
   */
  getAutomationHistory(userId, limit = 50) {
    return this.auditLogger.searchLogs({
      type: 'AUTOMATION_REQUEST',
      userId
    }).slice(-limit);
  }

  /**
   * Obter estatÃ­sticas de automaÃ§Ã£o
   */
  getAutomationStats(userId) {
    const logs = this.auditLogger.searchLogs({
      userId
    });
    const stats = {
      totalAutomations: logs.length,
      successfulAutomations: logs.filter(l => l.status === 'SUCCESS').length,
      failedAutomations: logs.filter(l => l.status === 'FAILED').length,
      blockedAutomations: logs.filter(l => l.status === 'BLOCKED').length,
      byMode: {},
      bySpecialist: {}
    };
    logs.forEach(log => {
      if (log.mode) {
        stats.byMode[log.mode] = (stats.byMode[log.mode] || 0) + 1;
      }
      if (log.selectedSpecialist) {
        stats.bySpecialist[log.selectedSpecialist] = (stats.bySpecialist[log.selectedSpecialist] || 0) + 1;
      }
    });
    return stats;
  }
}

// Exportar
if (typeof module !== 'undefined' && module.exports) {
  module.exports = AutomationEngine;
}
var _default = exports.default = AutomationEngine;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfU2VjdXJpdHlWYWxpZGF0b3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9BdWRpdExvZ2dlciIsIl9HaXRIdWJBdXRvbWF0aW9uIiwiX1NwZWNpYWxpc3RTZWxlY3RvciIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIkF1dG9tYXRpb25FbmdpbmUiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsIm1heFJldHJpZXMiLCJ0aW1lb3V0IiwiYWlNb2RlbCIsInRlbXBlcmF0dXJlIiwidmFsaWRhdG9yIiwiU2VjdXJpdHlWYWxpZGF0b3IiLCJhdWRpdExvZ2dlciIsIkF1ZGl0TG9nZ2VyIiwic3BlY2lhbGlzdFNlbGVjdG9yIiwiU3BlY2lhbGlzdFNlbGVjdG9yIiwiZ2l0SHViIiwiaW5pdGlhbGl6ZUdpdEh1YiIsInRva2VuIiwiR2l0SHViQXV0b21hdGlvbiIsImVycm9yIiwiY29uc29sZSIsImV4ZWN1dGVBdXRvbWF0aW9uIiwicmVxdWVzdCIsImF1dG9tYXRpb25JZCIsImxvZ0F1dG9tYXRpb25SZXF1ZXN0IiwidXNlcklkIiwidXNlcm5hbWUiLCJjb21tYW5kIiwibW9kZSIsInNlbGVjdGVkU3BlY2lhbGlzdCIsImRlc2NyaXB0aW9uIiwiaXBBZGRyZXNzIiwidXNlckFnZW50Iiwic2Vzc2lvbklkIiwicmVzdWx0Iiwic3RhdHVzIiwic3RlcHMiLCJlcnJvcnMiLCJsb2ciLCJhbmFseXNpcyIsImFuYWx5emVDb21tYW5kIiwicHVzaCIsInBoYXNlIiwiZGV0YWlscyIsInNwZWNpYWxpc3QiLCJzZWxlY3RTcGVjaWFsaXN0IiwidGFza1R5cGUiLCJrZXl3b3JkcyIsImNvZGVHZW5lcmF0aW9uIiwiZ2VuZXJhdGVDb2RlIiwicmVwb3NpdG9yeUluZm8iLCJmaWxlc0dlbmVyYXRlZCIsImZpbGVzIiwibGVuZ3RoIiwibGluZXNPZkNvZGUiLCJ0b3RhbExpbmVzIiwic2VjdXJpdHlWYWxpZGF0aW9uIiwidmFsaWRhdGVDb2RlIiwiaXNWYWxpZCIsIm1lc3NhZ2UiLCJsb2dTZWN1cml0eVZhbGlkYXRpb24iLCJmaWxlc0NoZWNrZWQiLCJzZXZlcml0eSIsIndhcm5pbmdzIiwiY29tbWl0UmVzdWx0IiwiY29tbWl0QW5kUHVzaCIsImNvbW1pdE1lc3NhZ2UiLCJjb21taXRIYXNoIiwiY29tbWl0Iiwic2hhIiwiZmlsZXNDaGFuZ2VkIiwicHJSZXN1bHQiLCJjcmVhdGVQUiIsImNyZWF0ZVB1bGxSZXF1ZXN0IiwicHJOdW1iZXIiLCJwciIsIm51bWJlciIsInByVXJsIiwidXJsIiwib3V0cHV0IiwibG9nQXV0b21hdGlvbkNvbXBsZXRpb24iLCJ0b3RhbER1cmF0aW9uIiwiZmlsZXNDcmVhdGVkIiwibGluZXNBZGRlZCIsImNyZWRpdHNVc2VkIiwic3RhY2siLCJsb2dFcnJvciIsImVycm9yVHlwZSIsIm5hbWUiLCJlcnJvck1lc3NhZ2UiLCJlcnJvclN0YWNrIiwidG9Mb3dlckNhc2UiLCJzcGxpdCIsImluY2x1ZGVzIiwic3Vic3RyaW5nIiwicGF0aCIsIkRhdGUiLCJub3ciLCJjb250ZW50IiwicmVkdWNlIiwic3VtIiwiZiIsInZhbGlkYXRpb24iLCJ2YWxpZGF0ZUZpbGVzIiwiZmxhdE1hcCIsImQiLCJFcnJvciIsIm93bmVyIiwicmVwbyIsImJyYW5jaCIsImVtYWlsIiwiYnJhbmNoTmFtZSIsImdldEF1dG9tYXRpb25IaXN0b3J5IiwibGltaXQiLCJzZWFyY2hMb2dzIiwidHlwZSIsInNsaWNlIiwiZ2V0QXV0b21hdGlvblN0YXRzIiwibG9ncyIsInN0YXRzIiwidG90YWxBdXRvbWF0aW9ucyIsInN1Y2Nlc3NmdWxBdXRvbWF0aW9ucyIsImZpbHRlciIsImwiLCJmYWlsZWRBdXRvbWF0aW9ucyIsImJsb2NrZWRBdXRvbWF0aW9ucyIsImJ5TW9kZSIsImJ5U3BlY2lhbGlzdCIsImZvckVhY2giLCJtb2R1bGUiLCJleHBvcnRzIiwiX2RlZmF1bHQiXSwic291cmNlcyI6WyJBdXRvbWF0aW9uRW5naW5lLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQVVUT01BVElPTiBFTkdJTkVcbiAqIE1vdG9yIGNlbnRyYWwgZGUgYXV0b21hw6fDo28gcXVlIG9ycXVlc3RyYSB0b2RvIG8gcHJvY2Vzc29cbiAqIENvb3JkZW5hOiBBbsOhbGlzZSDihpIgU2VsZcOnw6NvIGRlIEVzcGVjaWFsaXN0YSDihpIgR2VyYcOnw6NvIGRlIEPDs2RpZ28g4oaSIFZhbGlkYcOnw6NvIOKGkiBDb21taXRcbiAqL1xuXG5pbXBvcnQgU2VjdXJpdHlWYWxpZGF0b3IgZnJvbSAnLi9TZWN1cml0eVZhbGlkYXRvci5qcyc7XG5pbXBvcnQgQXVkaXRMb2dnZXIgZnJvbSAnLi9BdWRpdExvZ2dlci5qcyc7XG5pbXBvcnQgR2l0SHViQXV0b21hdGlvbiBmcm9tICcuL0dpdEh1YkF1dG9tYXRpb24uanMnO1xuaW1wb3J0IFNwZWNpYWxpc3RTZWxlY3RvciBmcm9tICcuL1NwZWNpYWxpc3RTZWxlY3Rvci5qcyc7XG5cbmNsYXNzIEF1dG9tYXRpb25FbmdpbmUge1xuICBjb25zdHJ1Y3Rvcihjb25maWcgPSB7fSkge1xuICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgbWF4UmV0cmllczogY29uZmlnLm1heFJldHJpZXMgfHwgMyxcbiAgICAgIHRpbWVvdXQ6IGNvbmZpZy50aW1lb3V0IHx8IDMwMDAwLFxuICAgICAgYWlNb2RlbDogY29uZmlnLmFpTW9kZWwgfHwgJ2dlbWluaS0yLjAtZmxhc2gnLFxuICAgICAgdGVtcGVyYXR1cmU6IGNvbmZpZy50ZW1wZXJhdHVyZSB8fCAwLjcsXG4gICAgICAuLi5jb25maWcsXG4gICAgfTtcblxuICAgIHRoaXMudmFsaWRhdG9yID0gbmV3IFNlY3VyaXR5VmFsaWRhdG9yKCk7XG4gICAgdGhpcy5hdWRpdExvZ2dlciA9IG5ldyBBdWRpdExvZ2dlcigpO1xuICAgIHRoaXMuc3BlY2lhbGlzdFNlbGVjdG9yID0gbmV3IFNwZWNpYWxpc3RTZWxlY3RvcigpO1xuICAgIFxuICAgIC8vIEdpdEh1YiBzZXLDoSBpbmljaWFsaXphZG8gcXVhbmRvIG5lY2Vzc8OhcmlvXG4gICAgdGhpcy5naXRIdWIgPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaWNpYWxpemFyIEdpdEh1YiBBdXRvbWF0aW9uXG4gICAqL1xuICBpbml0aWFsaXplR2l0SHViKHRva2VuKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuZ2l0SHViID0gbmV3IEdpdEh1YkF1dG9tYXRpb24odG9rZW4pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gaW5pY2lhbGl6YXIgR2l0SHViOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0YXIgYXV0b21hw6fDo28gY29tcGxldGFcbiAgICovXG4gIGFzeW5jIGV4ZWN1dGVBdXRvbWF0aW9uKHJlcXVlc3QpIHtcbiAgICBjb25zdCBhdXRvbWF0aW9uSWQgPSB0aGlzLmF1ZGl0TG9nZ2VyLmxvZ0F1dG9tYXRpb25SZXF1ZXN0KHtcbiAgICAgIHVzZXJJZDogcmVxdWVzdC51c2VySWQsXG4gICAgICB1c2VybmFtZTogcmVxdWVzdC51c2VybmFtZSxcbiAgICAgIGNvbW1hbmQ6IHJlcXVlc3QuY29tbWFuZCxcbiAgICAgIG1vZGU6IHJlcXVlc3QubW9kZSB8fCAnT1BUSU1JWkVEJyxcbiAgICAgIHNlbGVjdGVkU3BlY2lhbGlzdDogcmVxdWVzdC5zZWxlY3RlZFNwZWNpYWxpc3QsXG4gICAgICBkZXNjcmlwdGlvbjogcmVxdWVzdC5kZXNjcmlwdGlvbixcbiAgICAgIGlwQWRkcmVzczogcmVxdWVzdC5pcEFkZHJlc3MsXG4gICAgICB1c2VyQWdlbnQ6IHJlcXVlc3QudXNlckFnZW50LFxuICAgICAgc2Vzc2lvbklkOiByZXF1ZXN0LnNlc3Npb25JZCxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgIGF1dG9tYXRpb25JZCxcbiAgICAgIHN0YXR1czogJ0lOSVRJQVRFRCcsXG4gICAgICBzdGVwczogW10sXG4gICAgICBlcnJvcnM6IFtdLFxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgLy8gRmFzZSAxOiBBbsOhbGlzZSBkbyBjb21hbmRvXG4gICAgICBjb25zb2xlLmxvZyhgXFxu8J+TiyBGQVNFIDE6IEFuw6FsaXNlIGRvIGNvbWFuZG9gKTtcbiAgICAgIGNvbnN0IGFuYWx5c2lzID0gYXdhaXQgdGhpcy5hbmFseXplQ29tbWFuZChyZXF1ZXN0LmNvbW1hbmQpO1xuICAgICAgcmVzdWx0LnN0ZXBzLnB1c2goe1xuICAgICAgICBwaGFzZTogJ0FOQUxZU0lTJyxcbiAgICAgICAgc3RhdHVzOiAnQ09NUExFVEVEJyxcbiAgICAgICAgZGV0YWlsczogYW5hbHlzaXMsXG4gICAgICB9KTtcblxuICAgICAgLy8gRmFzZSAyOiBTZWxlw6fDo28gZGUgZXNwZWNpYWxpc3RhXG4gICAgICBjb25zb2xlLmxvZyhgXFxu8J+OryBGQVNFIDI6IFNlbGXDp8OjbyBkZSBlc3BlY2lhbGlzdGFgKTtcbiAgICAgIGxldCBzcGVjaWFsaXN0O1xuICAgICAgXG4gICAgICBpZiAocmVxdWVzdC5tb2RlID09PSAnSFlCUklEJyAmJiByZXF1ZXN0LnNlbGVjdGVkU3BlY2lhbGlzdCkge1xuICAgICAgICBzcGVjaWFsaXN0ID0gcmVxdWVzdC5zZWxlY3RlZFNwZWNpYWxpc3Q7XG4gICAgICAgIGNvbnNvbGUubG9nKGDinIUgRXNwZWNpYWxpc3RhIHNlbGVjaW9uYWRvIG1hbnVhbG1lbnRlOiAke3NwZWNpYWxpc3R9YCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzcGVjaWFsaXN0ID0gYXdhaXQgdGhpcy5zcGVjaWFsaXN0U2VsZWN0b3Iuc2VsZWN0U3BlY2lhbGlzdChcbiAgICAgICAgICBhbmFseXNpcy50YXNrVHlwZSxcbiAgICAgICAgICBhbmFseXNpcy5rZXl3b3Jkc1xuICAgICAgICApO1xuICAgICAgICBjb25zb2xlLmxvZyhg4pyFIEVzcGVjaWFsaXN0YSBzZWxlY2lvbmFkbyBhdXRvbWF0aWNhbWVudGU6ICR7c3BlY2lhbGlzdH1gKTtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0LnN0ZXBzLnB1c2goe1xuICAgICAgICBwaGFzZTogJ1NQRUNJQUxJU1RfU0VMRUNUSU9OJyxcbiAgICAgICAgc3RhdHVzOiAnQ09NUExFVEVEJyxcbiAgICAgICAgc3BlY2lhbGlzdCxcbiAgICAgICAgbW9kZTogcmVxdWVzdC5tb2RlLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEZhc2UgMzogR2VyYcOnw6NvIGRlIGPDs2RpZ29cbiAgICAgIGNvbnNvbGUubG9nKGBcXG7wn5K7IEZBU0UgMzogR2VyYcOnw6NvIGRlIGPDs2RpZ29gKTtcbiAgICAgIGNvbnN0IGNvZGVHZW5lcmF0aW9uID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUNvZGUoXG4gICAgICAgIGFuYWx5c2lzLFxuICAgICAgICBzcGVjaWFsaXN0LFxuICAgICAgICByZXF1ZXN0LnJlcG9zaXRvcnlJbmZvXG4gICAgICApO1xuICAgICAgXG4gICAgICByZXN1bHQuc3RlcHMucHVzaCh7XG4gICAgICAgIHBoYXNlOiAnQ09ERV9HRU5FUkFUSU9OJyxcbiAgICAgICAgc3RhdHVzOiAnQ09NUExFVEVEJyxcbiAgICAgICAgZmlsZXNHZW5lcmF0ZWQ6IGNvZGVHZW5lcmF0aW9uLmZpbGVzLmxlbmd0aCxcbiAgICAgICAgbGluZXNPZkNvZGU6IGNvZGVHZW5lcmF0aW9uLnRvdGFsTGluZXMsXG4gICAgICB9KTtcblxuICAgICAgLy8gRmFzZSA0OiBWYWxpZGHDp8OjbyBkZSBzZWd1cmFuw6dhXG4gICAgICBjb25zb2xlLmxvZyhgXFxu8J+UkCBGQVNFIDQ6IFZhbGlkYcOnw6NvIGRlIHNlZ3VyYW7Dp2FgKTtcbiAgICAgIGNvbnN0IHNlY3VyaXR5VmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVDb2RlKGNvZGVHZW5lcmF0aW9uLmZpbGVzKTtcbiAgICAgIFxuICAgICAgaWYgKCFzZWN1cml0eVZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICByZXN1bHQuc3RhdHVzID0gJ0JMT0NLRUQnO1xuICAgICAgICByZXN1bHQuZXJyb3JzLnB1c2goe1xuICAgICAgICAgIHBoYXNlOiAnU0VDVVJJVFlfVkFMSURBVElPTicsXG4gICAgICAgICAgbWVzc2FnZTogJ0PDs2RpZ28gYmxvcXVlYWRvIHBvciB2YWxpZGHDp8OjbyBkZSBzZWd1cmFuw6dhJyxcbiAgICAgICAgICBkZXRhaWxzOiBzZWN1cml0eVZhbGlkYXRpb24sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYXVkaXRMb2dnZXIubG9nU2VjdXJpdHlWYWxpZGF0aW9uKHtcbiAgICAgICAgICBhdXRvbWF0aW9uSWQsXG4gICAgICAgICAgZmlsZXNDaGVja2VkOiBjb2RlR2VuZXJhdGlvbi5maWxlcy5sZW5ndGgsXG4gICAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgICAgc2V2ZXJpdHk6IHNlY3VyaXR5VmFsaWRhdGlvbi5zZXZlcml0eSxcbiAgICAgICAgICBlcnJvcnM6IHNlY3VyaXR5VmFsaWRhdGlvbi5lcnJvcnMsXG4gICAgICAgICAgd2FybmluZ3M6IHNlY3VyaXR5VmFsaWRhdGlvbi53YXJuaW5ncyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0LnN0ZXBzLnB1c2goe1xuICAgICAgICBwaGFzZTogJ1NFQ1VSSVRZX1ZBTElEQVRJT04nLFxuICAgICAgICBzdGF0dXM6ICdDT01QTEVURUQnLFxuICAgICAgICB3YXJuaW5nczogc2VjdXJpdHlWYWxpZGF0aW9uLndhcm5pbmdzLmxlbmd0aCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGYXNlIDU6IENvbW1pdCArIFB1c2hcbiAgICAgIGNvbnNvbGUubG9nKGBcXG7wn5OdIEZBU0UgNTogQ29tbWl0ICsgUHVzaGApO1xuICAgICAgbGV0IGNvbW1pdFJlc3VsdCA9IG51bGw7XG4gICAgICBcbiAgICAgIGlmIChyZXF1ZXN0LnJlcG9zaXRvcnlJbmZvICYmIHRoaXMuZ2l0SHViKSB7XG4gICAgICAgIGNvbW1pdFJlc3VsdCA9IGF3YWl0IHRoaXMuY29tbWl0QW5kUHVzaChcbiAgICAgICAgICBjb2RlR2VuZXJhdGlvbi5maWxlcyxcbiAgICAgICAgICBhbmFseXNpcy5jb21taXRNZXNzYWdlLFxuICAgICAgICAgIHJlcXVlc3QucmVwb3NpdG9yeUluZm8sXG4gICAgICAgICAgc3BlY2lhbGlzdFxuICAgICAgICApO1xuXG4gICAgICAgIHJlc3VsdC5zdGVwcy5wdXNoKHtcbiAgICAgICAgICBwaGFzZTogJ0dJVF9DT01NSVQnLFxuICAgICAgICAgIHN0YXR1czogJ0NPTVBMRVRFRCcsXG4gICAgICAgICAgY29tbWl0SGFzaDogY29tbWl0UmVzdWx0LmNvbW1pdC5zaGEsXG4gICAgICAgICAgZmlsZXNDaGFuZ2VkOiBjb21taXRSZXN1bHQuZmlsZXNDaGFuZ2VkLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gRmFzZSA2OiBDcmlhciBQUiAob3BjaW9uYWwpXG4gICAgICBjb25zb2xlLmxvZyhgXFxu8J+UgCBGQVNFIDY6IENyaWFyIFB1bGwgUmVxdWVzdCAob3BjaW9uYWwpYCk7XG4gICAgICBsZXQgcHJSZXN1bHQgPSBudWxsO1xuICAgICAgXG4gICAgICBpZiAocmVxdWVzdC5jcmVhdGVQUiAmJiB0aGlzLmdpdEh1YiAmJiBjb21taXRSZXN1bHQpIHtcbiAgICAgICAgcHJSZXN1bHQgPSBhd2FpdCB0aGlzLmNyZWF0ZVB1bGxSZXF1ZXN0KFxuICAgICAgICAgIGFuYWx5c2lzLFxuICAgICAgICAgIHNwZWNpYWxpc3QsXG4gICAgICAgICAgcmVxdWVzdC5yZXBvc2l0b3J5SW5mb1xuICAgICAgICApO1xuXG4gICAgICAgIHJlc3VsdC5zdGVwcy5wdXNoKHtcbiAgICAgICAgICBwaGFzZTogJ0NSRUFURV9QUicsXG4gICAgICAgICAgc3RhdHVzOiAnQ09NUExFVEVEJyxcbiAgICAgICAgICBwck51bWJlcjogcHJSZXN1bHQucHIubnVtYmVyLFxuICAgICAgICAgIHByVXJsOiBwclJlc3VsdC5wci51cmwsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTdWNlc3NvIVxuICAgICAgcmVzdWx0LnN0YXR1cyA9ICdTVUNDRVNTJztcbiAgICAgIHJlc3VsdC5vdXRwdXQgPSB7XG4gICAgICAgIGZpbGVzOiBjb2RlR2VuZXJhdGlvbi5maWxlcyxcbiAgICAgICAgY29tbWl0OiBjb21taXRSZXN1bHQ/LmNvbW1pdCxcbiAgICAgICAgcHI6IHByUmVzdWx0Py5wcixcbiAgICAgIH07XG5cbiAgICAgIC8vIExvZyBkZSBjb25jbHVzw6NvXG4gICAgICB0aGlzLmF1ZGl0TG9nZ2VyLmxvZ0F1dG9tYXRpb25Db21wbGV0aW9uKHtcbiAgICAgICAgYXV0b21hdGlvbklkLFxuICAgICAgICB1c2VySWQ6IHJlcXVlc3QudXNlcklkLFxuICAgICAgICBzdGF0dXM6ICdTVUNDRVNTJyxcbiAgICAgICAgdG90YWxEdXJhdGlvbjogcmVzdWx0LnRvdGFsRHVyYXRpb24sXG4gICAgICAgIGNvbW1pdEhhc2g6IGNvbW1pdFJlc3VsdD8uY29tbWl0LnNoYSxcbiAgICAgICAgcHJVcmw6IHByUmVzdWx0Py5wci51cmwsXG4gICAgICAgIGZpbGVzQ3JlYXRlZDogY29kZUdlbmVyYXRpb24uZmlsZXMubGVuZ3RoLFxuICAgICAgICBsaW5lc0FkZGVkOiBjb2RlR2VuZXJhdGlvbi50b3RhbExpbmVzLFxuICAgICAgICBzcGVjaWFsaXN0LFxuICAgICAgICBtb2RlOiByZXF1ZXN0Lm1vZGUsXG4gICAgICAgIGNyZWRpdHNVc2VkOiByZXF1ZXN0LmNyZWRpdHNVc2VkLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBFcnJvIG5hIGF1dG9tYcOnw6NvOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG5cbiAgICAgIHJlc3VsdC5zdGF0dXMgPSAnRkFJTEVEJztcbiAgICAgIHJlc3VsdC5lcnJvcnMucHVzaCh7XG4gICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIHN0YWNrOiBlcnJvci5zdGFjayxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBMb2cgZGUgZXJyb1xuICAgICAgdGhpcy5hdWRpdExvZ2dlci5sb2dFcnJvcih7XG4gICAgICAgIGF1dG9tYXRpb25JZCxcbiAgICAgICAgdXNlcklkOiByZXF1ZXN0LnVzZXJJZCxcbiAgICAgICAgZXJyb3JUeXBlOiBlcnJvci5jb25zdHJ1Y3Rvci5uYW1lLFxuICAgICAgICBlcnJvck1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIGVycm9yU3RhY2s6IGVycm9yLnN0YWNrLFxuICAgICAgICBwaGFzZTogcmVzdWx0LnN0ZXBzW3Jlc3VsdC5zdGVwcy5sZW5ndGggLSAxXT8ucGhhc2UgfHwgJ1VOS05PV04nLFxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFuYWxpc2FyIGNvbWFuZG8gZG8gdXN1w6FyaW9cbiAgICovXG4gIGFzeW5jIGFuYWx5emVDb21tYW5kKGNvbW1hbmQpIHtcbiAgICAvLyBBcXVpIHNlcmlhIGNoYW1hZGEgdW1hIElBIHBhcmEgYW5hbGlzYXIgbyBjb21hbmRvXG4gICAgLy8gUG9yIGVucXVhbnRvLCBhbsOhbGlzZSBzaW1wbGVzXG4gICAgXG4gICAgY29uc3Qga2V5d29yZHMgPSBjb21tYW5kLnRvTG93ZXJDYXNlKCkuc3BsaXQoJyAnKTtcbiAgICBcbiAgICBsZXQgdGFza1R5cGUgPSAnR0VORVJBTCc7XG4gICAgaWYgKGNvbW1hbmQuaW5jbHVkZXMoJ2NvbXBvbmVudGUnKSB8fCBjb21tYW5kLmluY2x1ZGVzKCdjb21wb25lbnQnKSkgdGFza1R5cGUgPSAnQ09NUE9ORU5UJztcbiAgICBpZiAoY29tbWFuZC5pbmNsdWRlcygnZnVuw6fDo28nKSB8fCBjb21tYW5kLmluY2x1ZGVzKCdmdW5jdGlvbicpKSB0YXNrVHlwZSA9ICdGVU5DVElPTic7XG4gICAgaWYgKGNvbW1hbmQuaW5jbHVkZXMoJ3Rlc3RlJykgfHwgY29tbWFuZC5pbmNsdWRlcygndGVzdCcpKSB0YXNrVHlwZSA9ICdURVNUJztcbiAgICBpZiAoY29tbWFuZC5pbmNsdWRlcygnZXN0aWxvJykgfHwgY29tbWFuZC5pbmNsdWRlcygnc3R5bGUnKSkgdGFza1R5cGUgPSAnU1RZTEUnO1xuICAgIGlmIChjb21tYW5kLmluY2x1ZGVzKCdkb2N1bWVudGHDp8OjbycpIHx8IGNvbW1hbmQuaW5jbHVkZXMoJ2RvY3VtZW50YXRpb24nKSkgdGFza1R5cGUgPSAnRE9DVU1FTlRBVElPTic7XG4gICAgaWYgKGNvbW1hbmQuaW5jbHVkZXMoJ3JlZmF0b3InKSB8fCBjb21tYW5kLmluY2x1ZGVzKCdyZWZhY3RvcicpKSB0YXNrVHlwZSA9ICdSRUZBQ1RPUic7XG5cbiAgICByZXR1cm4ge1xuICAgICAgY29tbWFuZCxcbiAgICAgIHRhc2tUeXBlLFxuICAgICAga2V5d29yZHMsXG4gICAgICBjb21taXRNZXNzYWdlOiBgZmVhdDogJHtjb21tYW5kLnN1YnN0cmluZygwLCA1MCl9YCxcbiAgICAgIGRlc2NyaXB0aW9uOiBjb21tYW5kLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2VyYXIgY8OzZGlnbyB2aWEgSUFcbiAgICovXG4gIGFzeW5jIGdlbmVyYXRlQ29kZShhbmFseXNpcywgc3BlY2lhbGlzdCwgcmVwb3NpdG9yeUluZm8pIHtcbiAgICAvLyBBcXVpIHNlcmlhIGNoYW1hZGEgYSBJQSAoR2VtaW5pLCBHUk9RLCBldGMpXG4gICAgLy8gUG9yIGVucXVhbnRvLCBzaW11bGHDp8Ojb1xuICAgIFxuICAgIGNvbnNvbGUubG9nKGDwn6SWIEdlcmFuZG8gY8OzZGlnbyBjb20gJHtzcGVjaWFsaXN0fS4uLmApO1xuXG4gICAgLy8gU2ltdWxhciBnZXJhw6fDo28gZGUgY8OzZGlnb1xuICAgIGNvbnN0IGZpbGVzID0gW1xuICAgICAge1xuICAgICAgICBwYXRoOiBgc3JjL2dlbmVyYXRlZF8ke0RhdGUubm93KCl9LmpzYCxcbiAgICAgICAgY29udGVudDogYC8vIEdlcmFkbyBhdXRvbWF0aWNhbWVudGUgcG9yICR7c3BlY2lhbGlzdH1cXG4vLyBUYXJlZmE6ICR7YW5hbHlzaXMuZGVzY3JpcHRpb259XFxuXFxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2VuZXJhdGVkKCkge1xcbiAgLy8gQ8OzZGlnbyBnZXJhZG8gYXF1aVxcbn1cXG5gLFxuICAgICAgfSxcbiAgICBdO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGZpbGVzLFxuICAgICAgdG90YWxMaW5lczogZmlsZXMucmVkdWNlKChzdW0sIGYpID0+IHN1bSArIGYuY29udGVudC5zcGxpdCgnXFxuJykubGVuZ3RoLCAwKSxcbiAgICAgIHNwZWNpYWxpc3QsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGFyIGPDs2RpZ29cbiAgICovXG4gIGFzeW5jIHZhbGlkYXRlQ29kZShmaWxlcykge1xuICAgIGNvbnNvbGUubG9nKGDwn5SNIFZhbGlkYW5kbyAke2ZpbGVzLmxlbmd0aH0gYXJxdWl2b3MuLi5gKTtcblxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBhd2FpdCB0aGlzLnZhbGlkYXRvci52YWxpZGF0ZUZpbGVzKGZpbGVzKTtcblxuICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICBjb25zb2xlLmxvZyhg4p2MIFZhbGlkYcOnw6NvIGZhbGhvdSFgKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgICBzZXZlcml0eTogJ2NyaXRpY2FsJyxcbiAgICAgICAgZXJyb3JzOiB2YWxpZGF0aW9uLmRldGFpbHMuZmxhdE1hcChkID0+IGQuZXJyb3JzKSxcbiAgICAgICAgd2FybmluZ3M6IHZhbGlkYXRpb24uZGV0YWlscy5mbGF0TWFwKGQgPT4gZC53YXJuaW5ncyksXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGDinIUgQ8OzZGlnbyB2YWxpZGFkbyBjb20gc3VjZXNzbyFgKTtcbiAgICByZXR1cm4ge1xuICAgICAgaXNWYWxpZDogdHJ1ZSxcbiAgICAgIHNldmVyaXR5OiAnbm9uZScsXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgd2FybmluZ3M6IHZhbGlkYXRpb24uZGV0YWlscy5mbGF0TWFwKGQgPT4gZC53YXJuaW5ncyksXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGYXplciBjb21taXQgKyBwdXNoXG4gICAqL1xuICBhc3luYyBjb21taXRBbmRQdXNoKGZpbGVzLCBtZXNzYWdlLCByZXBvc2l0b3J5SW5mbywgc3BlY2lhbGlzdCkge1xuICAgIGNvbnNvbGUubG9nKGDwn5OdIEZhemVuZG8gY29tbWl0ICsgcHVzaC4uLmApO1xuXG4gICAgaWYgKCF0aGlzLmdpdEh1Yikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdHaXRIdWIgbsOjbyBpbmljaWFsaXphZG8nKTtcbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmdpdEh1Yi5jb21taXRBbmRQdXNoKFxuICAgICAgcmVwb3NpdG9yeUluZm8ub3duZXIsXG4gICAgICByZXBvc2l0b3J5SW5mby5yZXBvLFxuICAgICAgZmlsZXMsXG4gICAgICBtZXNzYWdlLFxuICAgICAgcmVwb3NpdG9yeUluZm8uYnJhbmNoIHx8ICdtYWluJyxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogYCR7c3BlY2lhbGlzdH0gQm90YCxcbiAgICAgICAgZW1haWw6IGAke3NwZWNpYWxpc3QudG9Mb3dlckNhc2UoKX1AcmttbWF4LmNvbWAsXG4gICAgICB9XG4gICAgKTtcblxuICAgIGNvbnNvbGUubG9nKGDinIUgQ29tbWl0IHJlYWxpemFkbzogJHtyZXN1bHQuY29tbWl0LnNoYS5zdWJzdHJpbmcoMCwgNyl9YCk7XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENyaWFyIFB1bGwgUmVxdWVzdFxuICAgKi9cbiAgYXN5bmMgY3JlYXRlUHVsbFJlcXVlc3QoYW5hbHlzaXMsIHNwZWNpYWxpc3QsIHJlcG9zaXRvcnlJbmZvKSB7XG4gICAgY29uc29sZS5sb2coYPCflIAgQ3JpYW5kbyBQdWxsIFJlcXVlc3QuLi5gKTtcblxuICAgIGlmICghdGhpcy5naXRIdWIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignR2l0SHViIG7Do28gaW5pY2lhbGl6YWRvJyk7XG4gICAgfVxuXG4gICAgY29uc3QgYnJhbmNoTmFtZSA9IGBhdXRvbWF0aW9uLyR7c3BlY2lhbGlzdC50b0xvd2VyQ2FzZSgpfS8ke0RhdGUubm93KCl9YDtcblxuICAgIGNvbnN0IHByID0gYXdhaXQgdGhpcy5naXRIdWIuY3JlYXRlUHVsbFJlcXVlc3QoXG4gICAgICByZXBvc2l0b3J5SW5mby5vd25lcixcbiAgICAgIHJlcG9zaXRvcnlJbmZvLnJlcG8sXG4gICAgICBgWyR7c3BlY2lhbGlzdH1dICR7YW5hbHlzaXMuY29tbWl0TWVzc2FnZX1gLFxuICAgICAgYEF1dG9tYcOnw6NvIGV4ZWN1dGFkYSBwb3IgJHtzcGVjaWFsaXN0fVxcblxcblRhcmVmYTogJHthbmFseXNpcy5kZXNjcmlwdGlvbn1gLFxuICAgICAgYnJhbmNoTmFtZSxcbiAgICAgIHJlcG9zaXRvcnlJbmZvLmJyYW5jaCB8fCAnbWFpbidcbiAgICApO1xuXG4gICAgY29uc29sZS5sb2coYOKchSBQUiBjcmlhZG86ICR7cHIudXJsfWApO1xuXG4gICAgcmV0dXJuIHsgcHIgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnRlciBoaXN0w7NyaWNvIGRlIGF1dG9tYcOnw7Vlc1xuICAgKi9cbiAgZ2V0QXV0b21hdGlvbkhpc3RvcnkodXNlcklkLCBsaW1pdCA9IDUwKSB7XG4gICAgcmV0dXJuIHRoaXMuYXVkaXRMb2dnZXIuc2VhcmNoTG9ncyh7XG4gICAgICB0eXBlOiAnQVVUT01BVElPTl9SRVFVRVNUJyxcbiAgICAgIHVzZXJJZCxcbiAgICB9KS5zbGljZSgtbGltaXQpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idGVyIGVzdGF0w61zdGljYXMgZGUgYXV0b21hw6fDo29cbiAgICovXG4gIGdldEF1dG9tYXRpb25TdGF0cyh1c2VySWQpIHtcbiAgICBjb25zdCBsb2dzID0gdGhpcy5hdWRpdExvZ2dlci5zZWFyY2hMb2dzKHsgdXNlcklkIH0pO1xuXG4gICAgY29uc3Qgc3RhdHMgPSB7XG4gICAgICB0b3RhbEF1dG9tYXRpb25zOiBsb2dzLmxlbmd0aCxcbiAgICAgIHN1Y2Nlc3NmdWxBdXRvbWF0aW9uczogbG9ncy5maWx0ZXIobCA9PiBsLnN0YXR1cyA9PT0gJ1NVQ0NFU1MnKS5sZW5ndGgsXG4gICAgICBmYWlsZWRBdXRvbWF0aW9uczogbG9ncy5maWx0ZXIobCA9PiBsLnN0YXR1cyA9PT0gJ0ZBSUxFRCcpLmxlbmd0aCxcbiAgICAgIGJsb2NrZWRBdXRvbWF0aW9uczogbG9ncy5maWx0ZXIobCA9PiBsLnN0YXR1cyA9PT0gJ0JMT0NLRUQnKS5sZW5ndGgsXG4gICAgICBieU1vZGU6IHt9LFxuICAgICAgYnlTcGVjaWFsaXN0OiB7fSxcbiAgICB9O1xuXG4gICAgbG9ncy5mb3JFYWNoKGxvZyA9PiB7XG4gICAgICBpZiAobG9nLm1vZGUpIHtcbiAgICAgICAgc3RhdHMuYnlNb2RlW2xvZy5tb2RlXSA9IChzdGF0cy5ieU1vZGVbbG9nLm1vZGVdIHx8IDApICsgMTtcbiAgICAgIH1cbiAgICAgIGlmIChsb2cuc2VsZWN0ZWRTcGVjaWFsaXN0KSB7XG4gICAgICAgIHN0YXRzLmJ5U3BlY2lhbGlzdFtsb2cuc2VsZWN0ZWRTcGVjaWFsaXN0XSA9IChzdGF0cy5ieVNwZWNpYWxpc3RbbG9nLnNlbGVjdGVkU3BlY2lhbGlzdF0gfHwgMCkgKyAxO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN0YXRzO1xuICB9XG59XG5cbi8vIEV4cG9ydGFyXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBBdXRvbWF0aW9uRW5naW5lO1xufVxuXG5leHBvcnQgZGVmYXVsdCBBdXRvbWF0aW9uRW5naW5lO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFNQSxJQUFBQSxrQkFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsWUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsaUJBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLG1CQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFBeUQsU0FBQUQsdUJBQUFLLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFUekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFPQSxNQUFNRyxnQkFBZ0IsQ0FBQztFQUNyQkMsV0FBV0EsQ0FBQ0MsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFO0lBQ3ZCLElBQUksQ0FBQ0EsTUFBTSxHQUFHO01BQ1pDLFVBQVUsRUFBRUQsTUFBTSxDQUFDQyxVQUFVLElBQUksQ0FBQztNQUNsQ0MsT0FBTyxFQUFFRixNQUFNLENBQUNFLE9BQU8sSUFBSSxLQUFLO01BQ2hDQyxPQUFPLEVBQUVILE1BQU0sQ0FBQ0csT0FBTyxJQUFJLGtCQUFrQjtNQUM3Q0MsV0FBVyxFQUFFSixNQUFNLENBQUNJLFdBQVcsSUFBSSxHQUFHO01BQ3RDLEdBQUdKO0lBQ0wsQ0FBQztJQUVELElBQUksQ0FBQ0ssU0FBUyxHQUFHLElBQUlDLDBCQUFpQixDQUFDLENBQUM7SUFDeEMsSUFBSSxDQUFDQyxXQUFXLEdBQUcsSUFBSUMsb0JBQVcsQ0FBQyxDQUFDO0lBQ3BDLElBQUksQ0FBQ0Msa0JBQWtCLEdBQUcsSUFBSUMsMkJBQWtCLENBQUMsQ0FBQzs7SUFFbEQ7SUFDQSxJQUFJLENBQUNDLE1BQU0sR0FBRyxJQUFJO0VBQ3BCOztFQUVBO0FBQ0Y7QUFDQTtFQUNFQyxnQkFBZ0JBLENBQUNDLEtBQUss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
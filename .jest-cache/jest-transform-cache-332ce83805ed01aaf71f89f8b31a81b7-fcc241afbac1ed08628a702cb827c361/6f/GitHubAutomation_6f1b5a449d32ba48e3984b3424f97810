ff7e115d2868954ce7581287c88eb83f
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
/**
 * GITHUB AUTOMATION
 * Integra√ß√£o completa com GitHub para commits, pushes e PRs autom√°ticos
 * Suporta: Criar commits, fazer push, criar PRs, gerenciar branches
 */

class GitHubAutomation {
  constructor(token) {
    this.token = token || process.env.GITHUB_TOKEN;
    this.baseUrl = 'https://api.github.com';
    this.headers = {
      'Accept': 'application/vnd.github.v3+json',
      'Authorization': `token ${this.token}`,
      'User-Agent': 'RKMMAX-Automation'
    };
    if (!this.token) {
      throw new Error('GITHUB_TOKEN n√£o configurado');
    }
  }

  /**
   * Obter informa√ß√µes do reposit√≥rio
   */
  async getRepositoryInfo(owner, repo) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`GitHub API error: ${response.status}`);
      }
      const data = await response.json();
      return {
        name: data.name,
        owner: data.owner.login,
        url: data.html_url,
        defaultBranch: data.default_branch,
        isPrivate: data.private,
        description: data.description
      };
    } catch (error) {
      throw new Error(`Erro ao obter info do repo: ${error.message}`);
    }
  }

  /**
   * Obter refer√™ncia de branch (SHA)
   */
  async getBranchRef(owner, repo, branch = 'main') {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/refs/heads/${branch}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Branch n√£o encontrado: ${branch}`);
      }
      const data = await response.json();
      return {
        branch,
        sha: data.object.sha,
        url: data.url
      };
    } catch (error) {
      throw new Error(`Erro ao obter branch: ${error.message}`);
    }
  }

  /**
   * Obter √°rvore de commits
   */
  async getCommitTree(owner, repo, sha) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/commits/${sha}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Commit n√£o encontrado: ${sha}`);
      }
      const data = await response.json();
      return {
        sha: data.sha,
        message: data.message,
        author: data.author,
        tree: data.tree
      };
    } catch (error) {
      throw new Error(`Erro ao obter √°rvore: ${error.message}`);
    }
  }

  /**
   * Criar blob (arquivo)
   */
  async createBlob(owner, repo, content, encoding = 'utf-8') {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/blobs`, {
        method: 'POST',
        headers: this.headers,
        body: JSON.stringify({
          content,
          encoding
        })
      });
      if (!response.ok) {
        throw new Error(`Erro ao criar blob: ${response.status}`);
      }
      const data = await response.json();
      return {
        sha: data.sha,
        url: data.url
      };
    } catch (error) {
      throw new Error(`Erro ao criar blob: ${error.message}`);
    }
  }

  /**
   * Criar √°rvore de arquivos
   */
  async createTree(owner, repo, files, baseTreeSha = null) {
    try {
      const tree = [];
      for (const file of files) {
        // Se for arquivo novo
        if (file.content) {
          const blob = await this.createBlob(owner, repo, file.content);
          tree.push({
            path: file.path,
            mode: '100644',
            // arquivo regular
            type: 'blob',
            sha: blob.sha
          });
        }
        // Se for deletar arquivo
        else if (file.delete) {
          tree.push({
            path: file.path,
            mode: '100644',
            type: 'blob',
            sha: null
          });
        }
      }
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/trees`, {
        method: 'POST',
        headers: this.headers,
        body: JSON.stringify({
          tree,
          base_tree: baseTreeSha
        })
      });
      if (!response.ok) {
        throw new Error(`Erro ao criar √°rvore: ${response.status}`);
      }
      const data = await response.json();
      return {
        sha: data.sha,
        url: data.url
      };
    } catch (error) {
      throw new Error(`Erro ao criar √°rvore: ${error.message}`);
    }
  }

  /**
   * Criar commit
   */
  async createCommit(owner, repo, message, treeSha, parentSha, author) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/commits`, {
        method: 'POST',
        headers: this.headers,
        body: JSON.stringify({
          message,
          tree: treeSha,
          parents: [parentSha],
          author: {
            name: author?.name || 'RKMMAX Bot',
            email: author?.email || 'bot@rkmmax.com',
            date: new Date().toISOString()
          }
        })
      });
      if (!response.ok) {
        throw new Error(`Erro ao criar commit: ${response.status}`);
      }
      const data = await response.json();
      return {
        sha: data.sha,
        message: data.message,
        author: data.author,
        url: data.html_url
      };
    } catch (error) {
      throw new Error(`Erro ao criar commit: ${error.message}`);
    }
  }

  /**
   * Atualizar refer√™ncia (fazer push)
   */
  async updateRef(owner, repo, branch, newSha, force = false) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/refs/heads/${branch}`, {
        method: 'PATCH',
        headers: this.headers,
        body: JSON.stringify({
          sha: newSha,
          force
        })
      });
      if (!response.ok) {
        throw new Error(`Erro ao atualizar refer√™ncia: ${response.status}`);
      }
      const data = await response.json();
      return {
        branch,
        sha: data.object.sha,
        updated: true
      };
    } catch (error) {
      throw new Error(`Erro ao fazer push: ${error.message}`);
    }
  }

  /**
   * Fluxo completo: Commit + Push
   */
  async commitAndPush(owner, repo, files, message, branch = 'main', author = null) {
    try {
      console.log(`üìù Iniciando commit em ${owner}/${repo}/${branch}`);

      // 1. Obter refer√™ncia atual do branch
      const branchRef = await this.getBranchRef(owner, repo, branch);
      console.log(`‚úÖ Branch encontrado: ${branchRef.sha.substring(0, 7)}`);

      // 2. Obter √°rvore atual
      const currentTree = await this.getCommitTree(owner, repo, branchRef.sha);
      console.log(`‚úÖ √Årvore obtida: ${currentTree.tree.sha.substring(0, 7)}`);

      // 3. Criar nova √°rvore com os arquivos
      const newTree = await this.createTree(owner, repo, files, currentTree.tree.sha);
      console.log(`‚úÖ Nova √°rvore criada: ${newTree.sha.substring(0, 7)}`);

      // 4. Criar novo commit
      const newCommit = await this.createCommit(owner, repo, message, newTree.sha, branchRef.sha, author);
      console.log(`‚úÖ Commit criado: ${newCommit.sha.substring(0, 7)}`);

      // 5. Fazer push (atualizar refer√™ncia)
      const push = await this.updateRef(owner, repo, branch, newCommit.sha);
      console.log(`‚úÖ Push realizado com sucesso!`);
      return {
        success: true,
        commit: newCommit,
        branch: push.branch,
        filesChanged: files.length
      };
    } catch (error) {
      console.error(`‚ùå Erro no commit/push: ${error.message}`);
      throw error;
    }
  }

  /**
   * Criar Pull Request
   */
  async createPullRequest(owner, repo, title, body, head, base = 'main') {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/pulls`, {
        method: 'POST',
        headers: this.headers,
        body: JSON.stringify({
          title,
          body,
          head,
          base
        })
      });
      if (!response.ok) {
        const error = await response.json();
        throw new Error(`Erro ao criar PR: ${error.message}`);
      }
      const data = await response.json();
      return {
        number: data.number,
        title: data.title,
        url: data.html_url,
        status: data.state
      };
    } catch (error) {
      throw new Error(`Erro ao criar PR: ${error.message}`);
    }
  }

  /**
   * Listar arquivos modificados em um commit
   */
  async getCommitFiles(owner, repo, commitSha) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/commits/${commitSha}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Commit n√£o encontrado: ${commitSha}`);
      }
      const data = await response.json();
      return {
        commit: commitSha,
        author: data.commit.author,
        message: data.commit.message,
        files: data.files.map(f => ({
          path: f.filename,
          status: f.status,
          additions: f.additions,
          deletions: f.deletions,
          changes: f.changes
        })),
        stats: {
          total: data.files.length,
          additions: data.stats.additions,
          deletions: data.stats.deletions
        }
      };
    } catch (error) {
      throw new Error(`Erro ao obter arquivos: ${error.message}`);
    }
  }

  /**
   * Obter conte√∫do de arquivo
   */
  async getFileContent(owner, repo, path, branch = 'main') {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/contents/${path}?ref=${branch}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Arquivo n√£o encontrado: ${path}`);
      }
      const data = await response.json();

      // Decodificar base64
      const content = Buffer.from(data.content, 'base64').toString('utf-8');
      return {
        path: data.path,
        content,
        sha: data.sha,
        size: data.size
      };
    } catch (error) {
      throw new Error(`Erro ao obter arquivo: ${error.message}`);
    }
  }

  /**
   * Criar branch
   */
  async createBranch(owner, repo, branchName, fromBranch = 'main') {
    try {
      // Obter SHA do branch origem
      const originBranch = await this.getBranchRef(owner, repo, fromBranch);

      // Criar novo branch
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/refs`, {
        method: 'POST',
        headers: this.headers,
        body: JSON.stringify({
          ref: `refs/heads/${branchName}`,
          sha: originBranch.sha
        })
      });
      if (!response.ok) {
        throw new Error(`Erro ao criar branch: ${response.status}`);
      }
      const data = await response.json();
      return {
        branch: branchName,
        sha: data.object.sha,
        created: true
      };
    } catch (error) {
      throw new Error(`Erro ao criar branch: ${error.message}`);
    }
  }

  /**
   * Deletar branch
   */
  async deleteBranch(owner, repo, branchName) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/refs/heads/${branchName}`, {
        method: 'DELETE',
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Erro ao deletar branch: ${response.status}`);
      }
      return {
        branch: branchName,
        deleted: true
      };
    } catch (error) {
      throw new Error(`Erro ao deletar branch: ${error.message}`);
    }
  }

  /**
   * Obter hist√≥rico de commits
   */
  async getCommitHistory(owner, repo, branch = 'main', limit = 10) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/commits?sha=${branch}&per_page=${limit}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Erro ao obter hist√≥rico: ${response.status}`);
      }
      const data = await response.json();
      return data.map(commit => ({
        sha: commit.sha,
        message: commit.commit.message,
        author: commit.commit.author.name,
        date: commit.commit.author.date,
        url: commit.html_url
      }));
    } catch (error) {
      throw new Error(`Erro ao obter hist√≥rico: ${error.message}`);
    }
  }
}

// Exportar
if (typeof module !== 'undefined' && module.exports) {
  module.exports = GitHubAutomation;
}
var _default = exports.default = GitHubAutomation;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJHaXRIdWJBdXRvbWF0aW9uIiwiY29uc3RydWN0b3IiLCJ0b2tlbiIsInByb2Nlc3MiLCJlbnYiLCJHSVRIVUJfVE9LRU4iLCJiYXNlVXJsIiwiaGVhZGVycyIsIkVycm9yIiwiZ2V0UmVwb3NpdG9yeUluZm8iLCJvd25lciIsInJlcG8iLCJyZXNwb25zZSIsImZldGNoIiwib2siLCJzdGF0dXMiLCJkYXRhIiwianNvbiIsIm5hbWUiLCJsb2dpbiIsInVybCIsImh0bWxfdXJsIiwiZGVmYXVsdEJyYW5jaCIsImRlZmF1bHRfYnJhbmNoIiwiaXNQcml2YXRlIiwicHJpdmF0ZSIsImRlc2NyaXB0aW9uIiwiZXJyb3IiLCJtZXNzYWdlIiwiZ2V0QnJhbmNoUmVmIiwiYnJhbmNoIiwic2hhIiwib2JqZWN0IiwiZ2V0Q29tbWl0VHJlZSIsImF1dGhvciIsInRyZWUiLCJjcmVhdGVCbG9iIiwiY29udGVudCIsImVuY29kaW5nIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjcmVhdGVUcmVlIiwiZmlsZXMiLCJiYXNlVHJlZVNoYSIsImZpbGUiLCJibG9iIiwicHVzaCIsInBhdGgiLCJtb2RlIiwidHlwZSIsImRlbGV0ZSIsImJhc2VfdHJlZSIsImNyZWF0ZUNvbW1pdCIsInRyZWVTaGEiLCJwYXJlbnRTaGEiLCJwYXJlbnRzIiwiZW1haWwiLCJkYXRlIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwidXBkYXRlUmVmIiwibmV3U2hhIiwiZm9yY2UiLCJ1cGRhdGVkIiwiY29tbWl0QW5kUHVzaCIsImNvbnNvbGUiLCJsb2ciLCJicmFuY2hSZWYiLCJzdWJzdHJpbmciLCJjdXJyZW50VHJlZSIsIm5ld1RyZWUiLCJuZXdDb21taXQiLCJzdWNjZXNzIiwiY29tbWl0IiwiZmlsZXNDaGFuZ2VkIiwibGVuZ3RoIiwiY3JlYXRlUHVsbFJlcXVlc3QiLCJ0aXRsZSIsImhlYWQiLCJiYXNlIiwibnVtYmVyIiwic3RhdGUiLCJnZXRDb21taXRGaWxlcyIsImNvbW1pdFNoYSIsIm1hcCIsImYiLCJmaWxlbmFtZSIsImFkZGl0aW9ucyIsImRlbGV0aW9ucyIsImNoYW5nZXMiLCJzdGF0cyIsInRvdGFsIiwiZ2V0RmlsZUNvbnRlbnQiLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJzaXplIiwiY3JlYXRlQnJhbmNoIiwiYnJhbmNoTmFtZSIsImZyb21CcmFuY2giLCJvcmlnaW5CcmFuY2giLCJyZWYiLCJjcmVhdGVkIiwiZGVsZXRlQnJhbmNoIiwiZGVsZXRlZCIsImdldENvbW1pdEhpc3RvcnkiLCJsaW1pdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJfZGVmYXVsdCIsImRlZmF1bHQiXSwic291cmNlcyI6WyJHaXRIdWJBdXRvbWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR0lUSFVCIEFVVE9NQVRJT05cbiAqIEludGVncmHDp8OjbyBjb21wbGV0YSBjb20gR2l0SHViIHBhcmEgY29tbWl0cywgcHVzaGVzIGUgUFJzIGF1dG9tw6F0aWNvc1xuICogU3Vwb3J0YTogQ3JpYXIgY29tbWl0cywgZmF6ZXIgcHVzaCwgY3JpYXIgUFJzLCBnZXJlbmNpYXIgYnJhbmNoZXNcbiAqL1xuXG5jbGFzcyBHaXRIdWJBdXRvbWF0aW9uIHtcbiAgY29uc3RydWN0b3IodG9rZW4pIHtcbiAgICB0aGlzLnRva2VuID0gdG9rZW4gfHwgcHJvY2Vzcy5lbnYuR0lUSFVCX1RPS0VOO1xuICAgIHRoaXMuYmFzZVVybCA9ICdodHRwczovL2FwaS5naXRodWIuY29tJztcbiAgICB0aGlzLmhlYWRlcnMgPSB7XG4gICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL3ZuZC5naXRodWIudjMranNvbicsXG4gICAgICAnQXV0aG9yaXphdGlvbic6IGB0b2tlbiAke3RoaXMudG9rZW59YCxcbiAgICAgICdVc2VyLUFnZW50JzogJ1JLTU1BWC1BdXRvbWF0aW9uJyxcbiAgICB9O1xuXG4gICAgaWYgKCF0aGlzLnRva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dJVEhVQl9UT0tFTiBuw6NvIGNvbmZpZ3VyYWRvJyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE9idGVyIGluZm9ybWHDp8O1ZXMgZG8gcmVwb3NpdMOzcmlvXG4gICAqL1xuICBhc3luYyBnZXRSZXBvc2l0b3J5SW5mbyhvd25lciwgcmVwbykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgJHt0aGlzLmJhc2VVcmx9L3JlcG9zLyR7b3duZXJ9LyR7cmVwb31gLFxuICAgICAgICB7IGhlYWRlcnM6IHRoaXMuaGVhZGVycyB9XG4gICAgICApO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgR2l0SHViIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgb3duZXI6IGRhdGEub3duZXIubG9naW4sXG4gICAgICAgIHVybDogZGF0YS5odG1sX3VybCxcbiAgICAgICAgZGVmYXVsdEJyYW5jaDogZGF0YS5kZWZhdWx0X2JyYW5jaCxcbiAgICAgICAgaXNQcml2YXRlOiBkYXRhLnByaXZhdGUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIG9idGVyIGluZm8gZG8gcmVwbzogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBPYnRlciByZWZlcsOqbmNpYSBkZSBicmFuY2ggKFNIQSlcbiAgICovXG4gIGFzeW5jIGdldEJyYW5jaFJlZihvd25lciwgcmVwbywgYnJhbmNoID0gJ21haW4nKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgIGAke3RoaXMuYmFzZVVybH0vcmVwb3MvJHtvd25lcn0vJHtyZXBvfS9naXQvcmVmcy9oZWFkcy8ke2JyYW5jaH1gLFxuICAgICAgICB7IGhlYWRlcnM6IHRoaXMuaGVhZGVycyB9XG4gICAgICApO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQnJhbmNoIG7Do28gZW5jb250cmFkbzogJHticmFuY2h9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGJyYW5jaCxcbiAgICAgICAgc2hhOiBkYXRhLm9iamVjdC5zaGEsXG4gICAgICAgIHVybDogZGF0YS51cmwsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gb2J0ZXIgYnJhbmNoOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE9idGVyIMOhcnZvcmUgZGUgY29tbWl0c1xuICAgKi9cbiAgYXN5bmMgZ2V0Q29tbWl0VHJlZShvd25lciwgcmVwbywgc2hhKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgIGAke3RoaXMuYmFzZVVybH0vcmVwb3MvJHtvd25lcn0vJHtyZXBvfS9naXQvY29tbWl0cy8ke3NoYX1gLFxuICAgICAgICB7IGhlYWRlcnM6IHRoaXMuaGVhZGVycyB9XG4gICAgICApO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ29tbWl0IG7Do28gZW5jb250cmFkbzogJHtzaGF9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHNoYTogZGF0YS5zaGEsXG4gICAgICAgIG1lc3NhZ2U6IGRhdGEubWVzc2FnZSxcbiAgICAgICAgYXV0aG9yOiBkYXRhLmF1dGhvcixcbiAgICAgICAgdHJlZTogZGF0YS50cmVlLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIG9idGVyIMOhcnZvcmU6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JpYXIgYmxvYiAoYXJxdWl2bylcbiAgICovXG4gIGFzeW5jIGNyZWF0ZUJsb2Iob3duZXIsIHJlcG8sIGNvbnRlbnQsIGVuY29kaW5nID0gJ3V0Zi04Jykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgJHt0aGlzLmJhc2VVcmx9L3JlcG9zLyR7b3duZXJ9LyR7cmVwb30vZ2l0L2Jsb2JzYCxcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgZW5jb2RpbmcsXG4gICAgICAgICAgfSksXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGNyaWFyIGJsb2I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzaGE6IGRhdGEuc2hhLFxuICAgICAgICB1cmw6IGRhdGEudXJsLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGNyaWFyIGJsb2I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JpYXIgw6Fydm9yZSBkZSBhcnF1aXZvc1xuICAgKi9cbiAgYXN5bmMgY3JlYXRlVHJlZShvd25lciwgcmVwbywgZmlsZXMsIGJhc2VUcmVlU2hhID0gbnVsbCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0cmVlID0gW107XG5cbiAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICAvLyBTZSBmb3IgYXJxdWl2byBub3ZvXG4gICAgICAgIGlmIChmaWxlLmNvbnRlbnQpIHtcbiAgICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgdGhpcy5jcmVhdGVCbG9iKG93bmVyLCByZXBvLCBmaWxlLmNvbnRlbnQpO1xuICAgICAgICAgIHRyZWUucHVzaCh7XG4gICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICBtb2RlOiAnMTAwNjQ0JywgLy8gYXJxdWl2byByZWd1bGFyXG4gICAgICAgICAgICB0eXBlOiAnYmxvYicsXG4gICAgICAgICAgICBzaGE6IGJsb2Iuc2hhLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNlIGZvciBkZWxldGFyIGFycXVpdm9cbiAgICAgICAgZWxzZSBpZiAoZmlsZS5kZWxldGUpIHtcbiAgICAgICAgICB0cmVlLnB1c2goe1xuICAgICAgICAgICAgcGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgbW9kZTogJzEwMDY0NCcsXG4gICAgICAgICAgICB0eXBlOiAnYmxvYicsXG4gICAgICAgICAgICBzaGE6IG51bGwsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgYCR7dGhpcy5iYXNlVXJsfS9yZXBvcy8ke293bmVyfS8ke3JlcG99L2dpdC90cmVlc2AsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgdHJlZSxcbiAgICAgICAgICAgIGJhc2VfdHJlZTogYmFzZVRyZWVTaGEsXG4gICAgICAgICAgfSksXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGNyaWFyIMOhcnZvcmU6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzaGE6IGRhdGEuc2hhLFxuICAgICAgICB1cmw6IGRhdGEudXJsLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGNyaWFyIMOhcnZvcmU6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JpYXIgY29tbWl0XG4gICAqL1xuICBhc3luYyBjcmVhdGVDb21taXQob3duZXIsIHJlcG8sIG1lc3NhZ2UsIHRyZWVTaGEsIHBhcmVudFNoYSwgYXV0aG9yKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgIGAke3RoaXMuYmFzZVVybH0vcmVwb3MvJHtvd25lcn0vJHtyZXBvfS9naXQvY29tbWl0c2AsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICAgIHRyZWU6IHRyZWVTaGEsXG4gICAgICAgICAgICBwYXJlbnRzOiBbcGFyZW50U2hhXSxcbiAgICAgICAgICAgIGF1dGhvcjoge1xuICAgICAgICAgICAgICBuYW1lOiBhdXRob3I/Lm5hbWUgfHwgJ1JLTU1BWCBCb3QnLFxuICAgICAgICAgICAgICBlbWFpbDogYXV0aG9yPy5lbWFpbCB8fCAnYm90QHJrbW1heC5jb20nLFxuICAgICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICB9XG4gICAgICApO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBjcmlhciBjb21taXQ6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzaGE6IGRhdGEuc2hhLFxuICAgICAgICBtZXNzYWdlOiBkYXRhLm1lc3NhZ2UsXG4gICAgICAgIGF1dGhvcjogZGF0YS5hdXRob3IsXG4gICAgICAgIHVybDogZGF0YS5odG1sX3VybCxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBjcmlhciBjb21taXQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXR1YWxpemFyIHJlZmVyw6puY2lhIChmYXplciBwdXNoKVxuICAgKi9cbiAgYXN5bmMgdXBkYXRlUmVmKG93bmVyLCByZXBvLCBicmFuY2gsIG5ld1NoYSwgZm9yY2UgPSBmYWxzZSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgJHt0aGlzLmJhc2VVcmx9L3JlcG9zLyR7b3duZXJ9LyR7cmVwb30vZ2l0L3JlZnMvaGVhZHMvJHticmFuY2h9YCxcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgc2hhOiBuZXdTaGEsXG4gICAgICAgICAgICBmb3JjZSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfVxuICAgICAgKTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gYXR1YWxpemFyIHJlZmVyw6puY2lhOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYnJhbmNoLFxuICAgICAgICBzaGE6IGRhdGEub2JqZWN0LnNoYSxcbiAgICAgICAgdXBkYXRlZDogdHJ1ZSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBmYXplciBwdXNoOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZsdXhvIGNvbXBsZXRvOiBDb21taXQgKyBQdXNoXG4gICAqL1xuICBhc3luYyBjb21taXRBbmRQdXNoKG93bmVyLCByZXBvLCBmaWxlcywgbWVzc2FnZSwgYnJhbmNoID0gJ21haW4nLCBhdXRob3IgPSBudWxsKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5OdIEluaWNpYW5kbyBjb21taXQgZW0gJHtvd25lcn0vJHtyZXBvfS8ke2JyYW5jaH1gKTtcblxuICAgICAgLy8gMS4gT2J0ZXIgcmVmZXLDqm5jaWEgYXR1YWwgZG8gYnJhbmNoXG4gICAgICBjb25zdCBicmFuY2hSZWYgPSBhd2FpdCB0aGlzLmdldEJyYW5jaFJlZihvd25lciwgcmVwbywgYnJhbmNoKTtcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgQnJhbmNoIGVuY29udHJhZG86ICR7YnJhbmNoUmVmLnNoYS5zdWJzdHJpbmcoMCwgNyl9YCk7XG5cbiAgICAgIC8vIDIuIE9idGVyIMOhcnZvcmUgYXR1YWxcbiAgICAgIGNvbnN0IGN1cnJlbnRUcmVlID0gYXdhaXQgdGhpcy5nZXRDb21taXRUcmVlKG93bmVyLCByZXBvLCBicmFuY2hSZWYuc2hhKTtcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgw4Fydm9yZSBvYnRpZGE6ICR7Y3VycmVudFRyZWUudHJlZS5zaGEuc3Vic3RyaW5nKDAsIDcpfWApO1xuXG4gICAgICAvLyAzLiBDcmlhciBub3ZhIMOhcnZvcmUgY29tIG9zIGFycXVpdm9zXG4gICAgICBjb25zdCBuZXdUcmVlID0gYXdhaXQgdGhpcy5jcmVhdGVUcmVlKG93bmVyLCByZXBvLCBmaWxlcywgY3VycmVudFRyZWUudHJlZS5zaGEpO1xuICAgICAgY29uc29sZS5sb2coYOKchSBOb3ZhIMOhcnZvcmUgY3JpYWRhOiAke25ld1RyZWUuc2hhLnN1YnN0cmluZygwLCA3KX1gKTtcblxuICAgICAgLy8gNC4gQ3JpYXIgbm92byBjb21taXRcbiAgICAgIGNvbnN0IG5ld0NvbW1pdCA9IGF3YWl0IHRoaXMuY3JlYXRlQ29tbWl0KFxuICAgICAgICBvd25lcixcbiAgICAgICAgcmVwbyxcbiAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgbmV3VHJlZS5zaGEsXG4gICAgICAgIGJyYW5jaFJlZi5zaGEsXG4gICAgICAgIGF1dGhvclxuICAgICAgKTtcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgQ29tbWl0IGNyaWFkbzogJHtuZXdDb21taXQuc2hhLnN1YnN0cmluZygwLCA3KX1gKTtcblxuICAgICAgLy8gNS4gRmF6ZXIgcHVzaCAoYXR1YWxpemFyIHJlZmVyw6puY2lhKVxuICAgICAgY29uc3QgcHVzaCA9IGF3YWl0IHRoaXMudXBkYXRlUmVmKG93bmVyLCByZXBvLCBicmFuY2gsIG5ld0NvbW1pdC5zaGEpO1xuICAgICAgY29uc29sZS5sb2coYOKchSBQdXNoIHJlYWxpemFkbyBjb20gc3VjZXNzbyFgKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgY29tbWl0OiBuZXdDb21taXQsXG4gICAgICAgIGJyYW5jaDogcHVzaC5icmFuY2gsXG4gICAgICAgIGZpbGVzQ2hhbmdlZDogZmlsZXMubGVuZ3RoLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihg4p2MIEVycm8gbm8gY29tbWl0L3B1c2g6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmlhciBQdWxsIFJlcXVlc3RcbiAgICovXG4gIGFzeW5jIGNyZWF0ZVB1bGxSZXF1ZXN0KG93bmVyLCByZXBvLCB0aXRsZSwgYm9keSwgaGVhZCwgYmFzZSA9ICdtYWluJykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgJHt0aGlzLmJhc2VVcmx9L3JlcG9zLyR7b3duZXJ9LyR7cmVwb30vcHVsbHNgLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgYm9keSxcbiAgICAgICAgICAgIGhlYWQsXG4gICAgICAgICAgICBiYXNlLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9XG4gICAgICApO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGVycm9yID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gY3JpYXIgUFI6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbnVtYmVyOiBkYXRhLm51bWJlcixcbiAgICAgICAgdGl0bGU6IGRhdGEudGl0bGUsXG4gICAgICAgIHVybDogZGF0YS5odG1sX3VybCxcbiAgICAgICAgc3RhdHVzOiBkYXRhLnN0YXRlLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGNyaWFyIFBSOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIExpc3RhciBhcnF1aXZvcyBtb2RpZmljYWRvcyBlbSB1bSBjb21taXRcbiAgICovXG4gIGFzeW5jIGdldENvbW1pdEZpbGVzKG93bmVyLCByZXBvLCBjb21taXRTaGEpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgYCR7dGhpcy5iYXNlVXJsfS9yZXBvcy8ke293bmVyfS8ke3JlcG99L2NvbW1pdHMvJHtjb21taXRTaGF9YCxcbiAgICAgICAgeyBoZWFkZXJzOiB0aGlzLmhlYWRlcnMgfVxuICAgICAgKTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvbW1pdCBuw6NvIGVuY29udHJhZG86ICR7Y29tbWl0U2hhfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb21taXQ6IGNvbW1pdFNoYSxcbiAgICAgICAgYXV0aG9yOiBkYXRhLmNvbW1pdC5hdXRob3IsXG4gICAgICAgIG1lc3NhZ2U6IGRhdGEuY29tbWl0Lm1lc3NhZ2UsXG4gICAgICAgIGZpbGVzOiBkYXRhLmZpbGVzLm1hcChmID0+ICh7XG4gICAgICAgICAgcGF0aDogZi5maWxlbmFtZSxcbiAgICAgICAgICBzdGF0dXM6IGYuc3RhdHVzLFxuICAgICAgICAgIGFkZGl0aW9uczogZi5hZGRpdGlvbnMsXG4gICAgICAgICAgZGVsZXRpb25zOiBmLmRlbGV0aW9ucyxcbiAgICAgICAgICBjaGFuZ2VzOiBmLmNoYW5nZXMsXG4gICAgICAgIH0pKSxcbiAgICAgICAgc3RhdHM6IHtcbiAgICAgICAgICB0b3RhbDogZGF0YS5maWxlcy5sZW5ndGgsXG4gICAgICAgICAgYWRkaXRpb25zOiBkYXRhLnN0YXRzLmFkZGl0aW9ucyxcbiAgICAgICAgICBkZWxldGlvbnM6IGRhdGEuc3RhdHMuZGVsZXRpb25zLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIG9idGVyIGFycXVpdm9zOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE9idGVyIGNvbnRlw7pkbyBkZSBhcnF1aXZvXG4gICAqL1xuICBhc3luYyBnZXRGaWxlQ29udGVudChvd25lciwgcmVwbywgcGF0aCwgYnJhbmNoID0gJ21haW4nKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgIGAke3RoaXMuYmFzZVVybH0vcmVwb3MvJHtvd25lcn0vJHtyZXBvfS9jb250ZW50cy8ke3BhdGh9P3JlZj0ke2JyYW5jaH1gLFxuICAgICAgICB7IGhlYWRlcnM6IHRoaXMuaGVhZGVycyB9XG4gICAgICApO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQXJxdWl2byBuw6NvIGVuY29udHJhZG86ICR7cGF0aH1gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgLy8gRGVjb2RpZmljYXIgYmFzZTY0XG4gICAgICBjb25zdCBjb250ZW50ID0gQnVmZmVyLmZyb20oZGF0YS5jb250ZW50LCAnYmFzZTY0JykudG9TdHJpbmcoJ3V0Zi04Jyk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGg6IGRhdGEucGF0aCxcbiAgICAgICAgY29udGVudCxcbiAgICAgICAgc2hhOiBkYXRhLnNoYSxcbiAgICAgICAgc2l6ZTogZGF0YS5zaXplLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIG9idGVyIGFycXVpdm86ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JpYXIgYnJhbmNoXG4gICAqL1xuICBhc3luYyBjcmVhdGVCcmFuY2gob3duZXIsIHJlcG8sIGJyYW5jaE5hbWUsIGZyb21CcmFuY2ggPSAnbWFpbicpIHtcbiAgICB0cnkge1xuICAgICAgLy8gT2J0ZXIgU0hBIGRvIGJyYW5jaCBvcmlnZW1cbiAgICAgIGNvbnN0IG9yaWdpbkJyYW5jaCA9IGF3YWl0IHRoaXMuZ2V0QnJhbmNoUmVmKG93bmVyLCByZXBvLCBmcm9tQnJhbmNoKTtcblxuICAgICAgLy8gQ3JpYXIgbm92byBicmFuY2hcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgIGAke3RoaXMuYmFzZVVybH0vcmVwb3MvJHtvd25lcn0vJHtyZXBvfS9naXQvcmVmc2AsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgcmVmOiBgcmVmcy9oZWFkcy8ke2JyYW5jaE5hbWV9YCxcbiAgICAgICAgICAgIHNoYTogb3JpZ2luQnJhbmNoLnNoYSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfVxuICAgICAgKTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gY3JpYXIgYnJhbmNoOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYnJhbmNoOiBicmFuY2hOYW1lLFxuICAgICAgICBzaGE6IGRhdGEub2JqZWN0LnNoYSxcbiAgICAgICAgY3JlYXRlZDogdHJ1ZSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBjcmlhciBicmFuY2g6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGVsZXRhciBicmFuY2hcbiAgICovXG4gIGFzeW5jIGRlbGV0ZUJyYW5jaChvd25lciwgcmVwbywgYnJhbmNoTmFtZSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgJHt0aGlzLmJhc2VVcmx9L3JlcG9zLyR7b3duZXJ9LyR7cmVwb30vZ2l0L3JlZnMvaGVhZHMvJHticmFuY2hOYW1lfWAsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgICAgfVxuICAgICAgKTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gZGVsZXRhciBicmFuY2g6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBicmFuY2g6IGJyYW5jaE5hbWUsXG4gICAgICAgIGRlbGV0ZWQ6IHRydWUsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gZGVsZXRhciBicmFuY2g6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogT2J0ZXIgaGlzdMOzcmljbyBkZSBjb21taXRzXG4gICAqL1xuICBhc3luYyBnZXRDb21taXRIaXN0b3J5KG93bmVyLCByZXBvLCBicmFuY2ggPSAnbWFpbicsIGxpbWl0ID0gMTApIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgYCR7dGhpcy5iYXNlVXJsfS9yZXBvcy8ke293bmVyfS8ke3JlcG99L2NvbW1pdHM/c2hhPSR7YnJhbmNofSZwZXJfcGFnZT0ke2xpbWl0fWAsXG4gICAgICAgIHsgaGVhZGVyczogdGhpcy5oZWFkZXJzIH1cbiAgICAgICk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIG9idGVyIGhpc3TDs3JpY286ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4gZGF0YS5tYXAoY29tbWl0ID0+ICh7XG4gICAgICAgIHNoYTogY29tbWl0LnNoYSxcbiAgICAgICAgbWVzc2FnZTogY29tbWl0LmNvbW1pdC5tZXNzYWdlLFxuICAgICAgICBhdXRob3I6IGNvbW1pdC5jb21taXQuYXV0aG9yLm5hbWUsXG4gICAgICAgIGRhdGU6IGNvbW1pdC5jb21taXQuYXV0aG9yLmRhdGUsXG4gICAgICAgIHVybDogY29tbWl0Lmh0bWxfdXJsLFxuICAgICAgfSkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gb2J0ZXIgaGlzdMOzcmljbzogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxufVxuXG4vLyBFeHBvcnRhclxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gIG1vZHVsZS5leHBvcnRzID0gR2l0SHViQXV0b21hdGlvbjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgR2l0SHViQXV0b21hdGlvbjtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNQSxnQkFBZ0IsQ0FBQztFQUNyQkMsV0FBV0EsQ0FBQ0MsS0FBSyxFQUFFO0lBQ2pCLElBQUksQ0FBQ0EsS0FBSyxHQUFHQSxLQUFLLElBQUlDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxZQUFZO0lBQzlDLElBQUksQ0FBQ0MsT0FBTyxHQUFHLHdCQUF3QjtJQUN2QyxJQUFJLENBQUNDLE9BQU8sR0FBRztNQUNiLFFBQVEsRUFBRSxnQ0FBZ0M7TUFDMUMsZUFBZSxFQUFFLFNBQVMsSUFBSSxDQUFDTCxLQUFLLEVBQUU7TUFDdEMsWUFBWSxFQUFFO0lBQ2hCLENBQUM7SUFFRCxJQUFJLENBQUMsSUFBSSxDQUFDQSxLQUFLLEVBQUU7TUFDZixNQUFNLElBQUlNLEtBQUssQ0FBQyw4QkFBOEIsQ0FBQztJQUNqRDtFQUNGOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE1BQU1DLGlCQUFpQkEsQ0FBQ0MsS0FBSyxFQUFFQyxJQUFJLEVBQUU7SUFDbkMsSUFBSTtNQUNGLE1BQU1DLFFBQVEsR0FBRyxNQUFNQyxLQUFLLENBQzFCLEdBQUcsSUFBSSxDQUFDUCxPQUFPLFVBQVVJLEtBQUssSUFBSUMsSUFBSSxFQUFFLEVBQ3hDO1FBQUVKLE9BQU8sRUFBRSxJQUFJLENBQUNBO01BQVEsQ0FDMUIsQ0FBQztNQUVELElBQUksQ0FBQ0ssUUFBUSxDQUFDRSxFQUFFLEVBQUU7UUFDaEIsTUFBTSxJQUFJTixLQUFLLENBQUMscUJBQXFCSSxRQUFRLENBQUNHLE1BQU0sRUFBRSxDQUFDO01BQ3pEO01BRUEsTUFBTUMsSUFBSSxHQUFHLE1BQU1KLFFBQVEsQ0FBQ0ssSUFBSSxDQUFDLENBQUM7TUFFbEMsT0FBTztRQUNMQyxJQUFJLEVB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
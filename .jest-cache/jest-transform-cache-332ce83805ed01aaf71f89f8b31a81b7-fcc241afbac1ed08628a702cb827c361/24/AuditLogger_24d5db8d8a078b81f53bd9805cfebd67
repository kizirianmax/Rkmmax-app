eaa22420b98c42f444bce1d5f493892d
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
/**
 * AUDIT LOGGER
 * Registra todas as ações de automação para auditoria e compliance
 * Rastreia: Quem pediu, O que foi feito, Quando, Status, Detalhes
 */

class AuditLogger {
  constructor() {
    this.logs = [];
    this.maxLogs = 10000; // Máximo de logs em memória
  }

  /**
   * Log de requisição de automação
   */
  logAutomationRequest(data) {
    const log = {
      id: this.generateLogId(),
      type: 'AUTOMATION_REQUEST',
      timestamp: new Date().toISOString(),
      userId: data.userId,
      username: data.username,
      command: data.command,
      mode: data.mode,
      // 'OPTIMIZED' ou 'HYBRID'
      selectedSpecialist: data.selectedSpecialist,
      suggestedSpecialist: data.suggestedSpecialist,
      description: data.description,
      status: 'INITIATED',
      details: {
        ipAddress: data.ipAddress,
        userAgent: data.userAgent,
        sessionId: data.sessionId
      }
    };
    this.addLog(log);
    return log.id;
  }

  /**
   * Log de análise de código
   */
  logCodeAnalysis(data) {
    const log = {
      id: this.generateLogId(),
      type: 'CODE_ANALYSIS',
      timestamp: new Date().toISOString(),
      automationId: data.automationId,
      specialist: data.specialist,
      filesAnalyzed: data.filesAnalyzed,
      codeGenerated: data.codeGenerated,
      linesOfCode: data.linesOfCode,
      status: 'COMPLETED',
      details: {
        analysisTime: data.analysisTime,
        model: data.model,
        temperature: data.temperature
      }
    };
    this.addLog(log);
    return log.id;
  }

  /**
   * Log de validação de segurança
   */
  logSecurityValidation(data) {
    const log = {
      id: this.generateLogId(),
      type: 'SECURITY_VALIDATION',
      timestamp: new Date().toISOString(),
      automationId: data.automationId,
      filesChecked: data.filesChecked,
      status: data.isValid ? 'PASSED' : 'BLOCKED',
      severity: data.severity,
      errors: data.errors || [],
      warnings: data.warnings || [],
      details: {
        validationTime: data.validationTime,
        blockedPatterns: data.blockedPatterns || [],
        credentialsFound: data.credentialsFound || []
      }
    };
    this.addLog(log);
    return log.id;
  }

  /**
   * Log de commit automático
   */
  logGitCommit(data) {
    const log = {
      id: this.generateLogId(),
      type: 'GIT_COMMIT',
      timestamp: new Date().toISOString(),
      automationId: data.automationId,
      commitHash: data.commitHash,
      commitMessage: data.commitMessage,
      branch: data.branch,
      filesChanged: data.filesChanged,
      insertions: data.insertions,
      deletions: data.deletions,
      status: 'COMPLETED',
      details: {
        author: data.author,
        pushedTo: data.pushedTo,
        prCreated: data.prCreated || false,
        prNumber: data.prNumber || null
      }
    };
    this.addLog(log);
    return log.id;
  }

  /**
   * Log de créditos debitados
   */
  logCreditDebit(data) {
    const log = {
      id: this.generateLogId(),
      type: 'CREDIT_DEBIT',
      timestamp: new Date().toISOString(),
      userId: data.userId,
      automationId: data.automationId,
      creditsDeducted: data.creditsDeducted,
      creditsRemaining: data.creditsRemaining,
      mode: data.mode,
      breakdown: {
        analysis: data.breakdown?.analysis || 0,
        codeGeneration: data.breakdown?.codeGeneration || 0,
        securityValidation: data.breakdown?.securityValidation || 0,
        gitOperations: data.breakdown?.gitOperations || 0
      },
      status: 'COMPLETED'
    };
    this.addLog(log);
    return log.id;
  }

  /**
   * Log de erro
   */
  logError(data) {
    const log = {
      id: this.generateLogId(),
      type: 'ERROR',
      timestamp: new Date().toISOString(),
      automationId: data.automationId,
      userId: data.userId,
      errorType: data.errorType,
      errorMessage: data.errorMessage,
      errorStack: data.errorStack,
      phase: data.phase,
      // 'ANALYSIS', 'CODE_GENERATION', 'SECURITY', 'GIT', etc
      status: 'FAILED',
      details: {
        recoveryAttempted: data.recoveryAttempted || false,
        recoverySuccessful: data.recoverySuccessful || false
      }
    };
    this.addLog(log);
    return log.id;
  }

  /**
   * Log de conclusão de automação
   */
  logAutomationCompletion(data) {
    const log = {
      id: this.generateLogId(),
      type: 'AUTOMATION_COMPLETION',
      timestamp: new Date().toISOString(),
      automationId: data.automationId,
      userId: data.userId,
      status: data.status,
      // 'SUCCESS' ou 'FAILED'
      totalDuration: data.totalDuration,
      commitHash: data.commitHash,
      prUrl: data.prUrl,
      summary: {
        filesCreated: data.filesCreated || 0,
        filesModified: data.filesModified || 0,
        filesDeleted: data.filesDeleted || 0,
        linesAdded: data.linesAdded || 0,
        linesRemoved: data.linesRemoved || 0
      },
      details: {
        specialist: data.specialist,
        mode: data.mode,
        creditsUsed: data.creditsUsed
      }
    };
    this.addLog(log);
    return log.id;
  }

  /**
   * Log de ação manual do usuário
   */
  logManualAction(data) {
    const log = {
      id: this.generateLogId(),
      type: 'MANUAL_ACTION',
      timestamp: new Date().toISOString(),
      userId: data.userId,
      username: data.username,
      action: data.action,
      // 'EDIT', 'REVIEW', 'APPROVE', 'REJECT', etc
      targetFile: data.targetFile,
      description: data.description,
      status: 'COMPLETED',
      details: {
        ipAddress: data.ipAddress,
        sessionId: data.sessionId
      }
    };
    this.addLog(log);
    return log.id;
  }

  /**
   * Log de acesso ao repositório
   */
  logRepositoryAccess(data) {
    const log = {
      id: this.generateLogId(),
      type: 'REPOSITORY_ACCESS',
      timestamp: new Date().toISOString(),
      userId: data.userId,
      action: data.action,
      // 'READ', 'WRITE', 'DELETE', etc
      repository: data.repository,
      branch: data.branch,
      filesAccessed: data.filesAccessed,
      status: 'COMPLETED',
      details: {
        ipAddress: data.ipAddress,
        userAgent: data.userAgent
      }
    };
    this.addLog(log);
    return log.id;
  }

  /**
   * Adicionar log à fila
   */
  addLog(log) {
    this.logs.push(log);

    // Manter limite de logs em memória
    if (this.logs.length > this.maxLogs) {
      this.logs = this.logs.slice(-this.maxLogs);
    }

    // Enviar para servidor (async)
    this.persistLog(log).catch(err => console.error('Erro ao persistir log:', err));
  }

  /**
   * Persistir log no servidor
   */
  async persistLog(log) {
    try {
      const response = await fetch('/api/audit-log', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(log)
      });
      if (!response.ok) {
        console.error('Erro ao persistir log:', response.status);
      }
    } catch (error) {
      console.error('Erro ao enviar log:', error);
    }
  }

  /**
   * Gerar ID único para log
   */
  generateLogId() {
    return `LOG_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
  }

  /**
   * Buscar logs por filtros
   */
  searchLogs(filters) {
    let results = this.logs;
    if (filters.type) {
      results = results.filter(log => log.type === filters.type);
    }
    if (filters.userId) {
      results = results.filter(log => log.userId === filters.userId);
    }
    if (filters.status) {
      results = results.filter(log => log.status === filters.status);
    }
    if (filters.startDate) {
      const start = new Date(filters.startDate);
      results = results.filter(log => new Date(log.timestamp) >= start);
    }
    if (filters.endDate) {
      const end = new Date(filters.endDate);
      results = results.filter(log => new Date(log.timestamp) <= end);
    }
    if (filters.automationId) {
      results = results.filter(log => log.automationId === filters.automationId);
    }
    return results;
  }

  /**
   * Gerar relatório de auditoria
   */
  generateAuditReport(filters = {}) {
    const logs = this.searchLogs(filters);
    const report = {
      generatedAt: new Date().toISOString(),
      filters,
      summary: {
        totalLogs: logs.length,
        byType: {},
        byStatus: {},
        byUser: {}
      },
      details: logs
    };

    // Contar por tipo
    logs.forEach(log => {
      report.summary.byType[log.type] = (report.summary.byType[log.type] || 0) + 1;
      report.summary.byStatus[log.status] = (report.summary.byStatus[log.status] || 0) + 1;
      report.summary.byUser[log.userId] = (report.summary.byUser[log.userId] || 0) + 1;
    });
    return report;
  }

  /**
   * Exportar logs em JSON
   */
  exportLogs(filters = {}) {
    const logs = this.searchLogs(filters);
    return JSON.stringify(logs, null, 2);
  }

  /**
   * Exportar logs em CSV
   */
  exportLogsCSV(filters = {}) {
    const logs = this.searchLogs(filters);
    if (logs.length === 0) return '';

    // Headers
    const headers = Object.keys(logs[0]);
    const csv = [headers.join(',')];

    // Rows
    logs.forEach(log => {
      const row = headers.map(header => {
        const value = log[header];
        if (typeof value === 'object') {
          return `"${JSON.stringify(value).replace(/"/g, '""')}"`;
        }
        return `"${String(value).replace(/"/g, '""')}"`;
      });
      csv.push(row.join(','));
    });
    return csv.join('\n');
  }

  /**
   * Limpar logs antigos
   */
  clearOldLogs(daysToKeep = 30) {
    const cutoffDate = new Date();
    cutoffDate.setDate(cutoffDate.getDate() - daysToKeep);
    const beforeCount = this.logs.length;
    this.logs = this.logs.filter(log => new Date(log.timestamp) > cutoffDate);
    return {
      logsRemoved: beforeCount - this.logs.length,
      logsRemaining: this.logs.length
    };
  }

  /**
   * Obter estatísticas
   */
  getStatistics() {
    const stats = {
      totalLogs: this.logs.length,
      logTypes: {},
      statusCounts: {},
      userActivity: {},
      timeRange: {
        oldest: this.logs.length > 0 ? this.logs[0].timestamp : null,
        newest: this.logs.length > 0 ? this.logs[this.logs.length - 1].timestamp : null
      }
    };
    this.logs.forEach(log => {
      stats.logTypes[log.type] = (stats.logTypes[log.type] || 0) + 1;
      stats.statusCounts[log.status] = (stats.statusCounts[log.status] || 0) + 1;
      if (log.userId) {
        stats.userActivity[log.userId] = (stats.userActivity[log.userId] || 0) + 1;
      }
    });
    return stats;
  }
}

// Exportar
if (typeof module !== 'undefined' && module.exports) {
  module.exports = AuditLogger;
}
var _default = exports.default = AuditLogger;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBdWRpdExvZ2dlciIsImNvbnN0cnVjdG9yIiwibG9ncyIsIm1heExvZ3MiLCJsb2dBdXRvbWF0aW9uUmVxdWVzdCIsImRhdGEiLCJsb2ciLCJpZCIsImdlbmVyYXRlTG9nSWQiLCJ0eXBlIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwidXNlcklkIiwidXNlcm5hbWUiLCJjb21tYW5kIiwibW9kZSIsInNlbGVjdGVkU3BlY2lhbGlzdCIsInN1Z2dlc3RlZFNwZWNpYWxpc3QiLCJkZXNjcmlwdGlvbiIsInN0YXR1cyIsImRldGFpbHMiLCJpcEFkZHJlc3MiLCJ1c2VyQWdlbnQiLCJzZXNzaW9uSWQiLCJhZGRMb2ciLCJsb2dDb2RlQW5hbHlzaXMiLCJhdXRvbWF0aW9uSWQiLCJzcGVjaWFsaXN0IiwiZmlsZXNBbmFseXplZCIsImNvZGVHZW5lcmF0ZWQiLCJsaW5lc09mQ29kZSIsImFuYWx5c2lzVGltZSIsIm1vZGVsIiwidGVtcGVyYXR1cmUiLCJsb2dTZWN1cml0eVZhbGlkYXRpb24iLCJmaWxlc0NoZWNrZWQiLCJpc1ZhbGlkIiwic2V2ZXJpdHkiLCJlcnJvcnMiLCJ3YXJuaW5ncyIsInZhbGlkYXRpb25UaW1lIiwiYmxvY2tlZFBhdHRlcm5zIiwiY3JlZGVudGlhbHNGb3VuZCIsImxvZ0dpdENvbW1pdCIsImNvbW1pdEhhc2giLCJjb21taXRNZXNzYWdlIiwiYnJhbmNoIiwiZmlsZXNDaGFuZ2VkIiwiaW5zZXJ0aW9ucyIsImRlbGV0aW9ucyIsImF1dGhvciIsInB1c2hlZFRvIiwicHJDcmVhdGVkIiwicHJOdW1iZXIiLCJsb2dDcmVkaXREZWJpdCIsImNyZWRpdHNEZWR1Y3RlZCIsImNyZWRpdHNSZW1haW5pbmciLCJicmVha2Rvd24iLCJhbmFseXNpcyIsImNvZGVHZW5lcmF0aW9uIiwic2VjdXJpdHlWYWxpZGF0aW9uIiwiZ2l0T3BlcmF0aW9ucyIsImxvZ0Vycm9yIiwiZXJyb3JUeXBlIiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JTdGFjayIsInBoYXNlIiwicmVjb3ZlcnlBdHRlbXB0ZWQiLCJyZWNvdmVyeVN1Y2Nlc3NmdWwiLCJsb2dBdXRvbWF0aW9uQ29tcGxldGlvbiIsInRvdGFsRHVyYXRpb24iLCJwclVybCIsInN1bW1hcnkiLCJmaWxlc0NyZWF0ZWQiLCJmaWxlc01vZGlmaWVkIiwiZmlsZXNEZWxldGVkIiwibGluZXNBZGRlZCIsImxpbmVzUmVtb3ZlZCIsImNyZWRpdHNVc2VkIiwibG9nTWFudWFsQWN0aW9uIiwiYWN0aW9uIiwidGFyZ2V0RmlsZSIsImxvZ1JlcG9zaXRvcnlBY2Nlc3MiLCJyZXBvc2l0b3J5IiwiZmlsZXNBY2Nlc3NlZCIsInB1c2giLCJsZW5ndGgiLCJzbGljZSIsInBlcnNpc3RMb2ciLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJvayIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsInNlYXJjaExvZ3MiLCJmaWx0ZXJzIiwicmVzdWx0cyIsImZpbHRlciIsInN0YXJ0RGF0ZSIsInN0YXJ0IiwiZW5kRGF0ZSIsImVuZCIsImdlbmVyYXRlQXVkaXRSZXBvcnQiLCJyZXBvcnQiLCJnZW5lcmF0ZWRBdCIsInRvdGFsTG9ncyIsImJ5VHlwZSIsImJ5U3RhdHVzIiwiYnlVc2VyIiwiZm9yRWFjaCIsImV4cG9ydExvZ3MiLCJleHBvcnRMb2dzQ1NWIiwiT2JqZWN0Iiwia2V5cyIsImNzdiIsImpvaW4iLCJyb3ciLCJtYXAiLCJoZWFkZXIiLCJ2YWx1ZSIsInJlcGxhY2UiLCJTdHJpbmciLCJjbGVhck9sZExvZ3MiLCJkYXlzVG9LZWVwIiwiY3V0b2ZmRGF0ZSIsInNldERhdGUiLCJnZXREYXRlIiwiYmVmb3JlQ291bnQiLCJsb2dzUmVtb3ZlZCIsImxvZ3NSZW1haW5pbmciLCJnZXRTdGF0aXN0aWNzIiwic3RhdHMiLCJsb2dUeXBlcyIsInN0YXR1c0NvdW50cyIsInVzZXJBY3Rpdml0eSIsInRpbWVSYW5nZSIsIm9sZGVzdCIsIm5ld2VzdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJfZGVmYXVsdCIsImRlZmF1bHQiXSwic291cmNlcyI6WyJBdWRpdExvZ2dlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFVRElUIExPR0dFUlxuICogUmVnaXN0cmEgdG9kYXMgYXMgYcOnw7VlcyBkZSBhdXRvbWHDp8OjbyBwYXJhIGF1ZGl0b3JpYSBlIGNvbXBsaWFuY2VcbiAqIFJhc3RyZWlhOiBRdWVtIHBlZGl1LCBPIHF1ZSBmb2kgZmVpdG8sIFF1YW5kbywgU3RhdHVzLCBEZXRhbGhlc1xuICovXG5cbmNsYXNzIEF1ZGl0TG9nZ2VyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5sb2dzID0gW107XG4gICAgdGhpcy5tYXhMb2dzID0gMTAwMDA7IC8vIE3DoXhpbW8gZGUgbG9ncyBlbSBtZW3Ds3JpYVxuICB9XG5cbiAgLyoqXG4gICAqIExvZyBkZSByZXF1aXNpw6fDo28gZGUgYXV0b21hw6fDo29cbiAgICovXG4gIGxvZ0F1dG9tYXRpb25SZXF1ZXN0KGRhdGEpIHtcbiAgICBjb25zdCBsb2cgPSB7XG4gICAgICBpZDogdGhpcy5nZW5lcmF0ZUxvZ0lkKCksXG4gICAgICB0eXBlOiAnQVVUT01BVElPTl9SRVFVRVNUJyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcbiAgICAgIHVzZXJuYW1lOiBkYXRhLnVzZXJuYW1lLFxuICAgICAgY29tbWFuZDogZGF0YS5jb21tYW5kLFxuICAgICAgbW9kZTogZGF0YS5tb2RlLCAvLyAnT1BUSU1JWkVEJyBvdSAnSFlCUklEJ1xuICAgICAgc2VsZWN0ZWRTcGVjaWFsaXN0OiBkYXRhLnNlbGVjdGVkU3BlY2lhbGlzdCxcbiAgICAgIHN1Z2dlc3RlZFNwZWNpYWxpc3Q6IGRhdGEuc3VnZ2VzdGVkU3BlY2lhbGlzdCxcbiAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgc3RhdHVzOiAnSU5JVElBVEVEJyxcbiAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgaXBBZGRyZXNzOiBkYXRhLmlwQWRkcmVzcyxcbiAgICAgICAgdXNlckFnZW50OiBkYXRhLnVzZXJBZ2VudCxcbiAgICAgICAgc2Vzc2lvbklkOiBkYXRhLnNlc3Npb25JZCxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHRoaXMuYWRkTG9nKGxvZyk7XG4gICAgcmV0dXJuIGxvZy5pZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgZGUgYW7DoWxpc2UgZGUgY8OzZGlnb1xuICAgKi9cbiAgbG9nQ29kZUFuYWx5c2lzKGRhdGEpIHtcbiAgICBjb25zdCBsb2cgPSB7XG4gICAgICBpZDogdGhpcy5nZW5lcmF0ZUxvZ0lkKCksXG4gICAgICB0eXBlOiAnQ09ERV9BTkFMWVNJUycsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGF1dG9tYXRpb25JZDogZGF0YS5hdXRvbWF0aW9uSWQsXG4gICAgICBzcGVjaWFsaXN0OiBkYXRhLnNwZWNpYWxpc3QsXG4gICAgICBmaWxlc0FuYWx5emVkOiBkYXRhLmZpbGVzQW5hbHl6ZWQsXG4gICAgICBjb2RlR2VuZXJhdGVkOiBkYXRhLmNvZGVHZW5lcmF0ZWQsXG4gICAgICBsaW5lc09mQ29kZTogZGF0YS5saW5lc09mQ29kZSxcbiAgICAgIHN0YXR1czogJ0NPTVBMRVRFRCcsXG4gICAgICBkZXRhaWxzOiB7XG4gICAgICAgIGFuYWx5c2lzVGltZTogZGF0YS5hbmFseXNpc1RpbWUsXG4gICAgICAgIG1vZGVsOiBkYXRhLm1vZGVsLFxuICAgICAgICB0ZW1wZXJhdHVyZTogZGF0YS50ZW1wZXJhdHVyZSxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHRoaXMuYWRkTG9nKGxvZyk7XG4gICAgcmV0dXJuIGxvZy5pZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgZGUgdmFsaWRhw6fDo28gZGUgc2VndXJhbsOnYVxuICAgKi9cbiAgbG9nU2VjdXJpdHlWYWxpZGF0aW9uKGRhdGEpIHtcbiAgICBjb25zdCBsb2cgPSB7XG4gICAgICBpZDogdGhpcy5nZW5lcmF0ZUxvZ0lkKCksXG4gICAgICB0eXBlOiAnU0VDVVJJVFlfVkFMSURBVElPTicsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGF1dG9tYXRpb25JZDogZGF0YS5hdXRvbWF0aW9uSWQsXG4gICAgICBmaWxlc0NoZWNrZWQ6IGRhdGEuZmlsZXNDaGVja2VkLFxuICAgICAgc3RhdHVzOiBkYXRhLmlzVmFsaWQgPyAnUEFTU0VEJyA6ICdCTE9DS0VEJyxcbiAgICAgIHNldmVyaXR5OiBkYXRhLnNldmVyaXR5LFxuICAgICAgZXJyb3JzOiBkYXRhLmVycm9ycyB8fCBbXSxcbiAgICAgIHdhcm5pbmdzOiBkYXRhLndhcm5pbmdzIHx8IFtdLFxuICAgICAgZGV0YWlsczoge1xuICAgICAgICB2YWxpZGF0aW9uVGltZTogZGF0YS52YWxpZGF0aW9uVGltZSxcbiAgICAgICAgYmxvY2tlZFBhdHRlcm5zOiBkYXRhLmJsb2NrZWRQYXR0ZXJucyB8fCBbXSxcbiAgICAgICAgY3JlZGVudGlhbHNGb3VuZDogZGF0YS5jcmVkZW50aWFsc0ZvdW5kIHx8IFtdLFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgdGhpcy5hZGRMb2cobG9nKTtcbiAgICByZXR1cm4gbG9nLmlkO1xuICB9XG5cbiAgLyoqXG4gICAqIExvZyBkZSBjb21taXQgYXV0b23DoXRpY29cbiAgICovXG4gIGxvZ0dpdENvbW1pdChkYXRhKSB7XG4gICAgY29uc3QgbG9nID0ge1xuICAgICAgaWQ6IHRoaXMuZ2VuZXJhdGVMb2dJZCgpLFxuICAgICAgdHlwZTogJ0dJVF9DT01NSVQnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBhdXRvbWF0aW9uSWQ6IGRhdGEuYXV0b21hdGlvbklkLFxuICAgICAgY29tbWl0SGFzaDogZGF0YS5jb21taXRIYXNoLFxuICAgICAgY29tbWl0TWVzc2FnZTogZGF0YS5jb21taXRNZXNzYWdlLFxuICAgICAgYnJhbmNoOiBkYXRhLmJyYW5jaCxcbiAgICAgIGZpbGVzQ2hhbmdlZDogZGF0YS5maWxlc0NoYW5nZWQsXG4gICAgICBpbnNlcnRpb25zOiBkYXRhLmluc2VydGlvbnMsXG4gICAgICBkZWxldGlvbnM6IGRhdGEuZGVsZXRpb25zLFxuICAgICAgc3RhdHVzOiAnQ09NUExFVEVEJyxcbiAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgYXV0aG9yOiBkYXRhLmF1dGhvcixcbiAgICAgICAgcHVzaGVkVG86IGRhdGEucHVzaGVkVG8sXG4gICAgICAgIHByQ3JlYXRlZDogZGF0YS5wckNyZWF0ZWQgfHwgZmFsc2UsXG4gICAgICAgIHByTnVtYmVyOiBkYXRhLnByTnVtYmVyIHx8IG51bGwsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICB0aGlzLmFkZExvZyhsb2cpO1xuICAgIHJldHVybiBsb2cuaWQ7XG4gIH1cblxuICAvKipcbiAgICogTG9nIGRlIGNyw6lkaXRvcyBkZWJpdGFkb3NcbiAgICovXG4gIGxvZ0NyZWRpdERlYml0KGRhdGEpIHtcbiAgICBjb25zdCBsb2cgPSB7XG4gICAgICBpZDogdGhpcy5nZW5lcmF0ZUxvZ0lkKCksXG4gICAgICB0eXBlOiAnQ1JFRElUX0RFQklUJyxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcbiAgICAgIGF1dG9tYXRpb25JZDogZGF0YS5hdXRvbWF0aW9uSWQsXG4gICAgICBjcmVkaXRzRGVkdWN0ZWQ6IGRhdGEuY3JlZGl0c0RlZHVjdGVkLFxuICAgICAgY3JlZGl0c1JlbWFpbmluZzogZGF0YS5jcmVkaXRzUmVtYWluaW5nLFxuICAgICAgbW9kZTogZGF0YS5tb2RlLFxuICAgICAgYnJlYWtkb3duOiB7XG4gICAgICAgIGFuYWx5c2lzOiBkYXRhLmJyZWFrZG93bj8uYW5hbHlzaXMgfHwgMCxcbiAgICAgICAgY29kZUdlbmVyYXRpb246IGRhdGEuYnJlYWtkb3duPy5jb2RlR2VuZXJhdGlvbiB8fCAwLFxuICAgICAgICBzZWN1cml0eVZhbGlkYXRpb246IGRhdGEuYnJlYWtkb3duPy5zZWN1cml0eVZhbGlkYXRpb24gfHwgMCxcbiAgICAgICAgZ2l0T3BlcmF0aW9uczogZGF0YS5icmVha2Rvd24/LmdpdE9wZXJhdGlvbnMgfHwgMCxcbiAgICAgIH0sXG4gICAgICBzdGF0dXM6ICdDT01QTEVURUQnLFxuICAgIH07XG5cbiAgICB0aGlzLmFkZExvZyhsb2cpO1xuICAgIHJldHVybiBsb2cuaWQ7XG4gIH1cblxuICAvKipcbiAgICogTG9nIGRlIGVycm9cbiAgICovXG4gIGxvZ0Vycm9yKGRhdGEpIHtcbiAgICBjb25zdCBsb2cgPSB7XG4gICAgICBpZDogdGhpcy5nZW5lcmF0ZUxvZ0lkKCksXG4gICAgICB0eXBlOiAnRVJST1InLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBhdXRvbWF0aW9uSWQ6IGRhdGEuYXV0b21hdGlvbklkLFxuICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcbiAgICAgIGVycm9yVHlwZTogZGF0YS5lcnJvclR5cGUsXG4gICAgICBlcnJvck1lc3NhZ2U6IGRhdGEuZXJyb3JNZXNzYWdlLFxuICAgICAgZXJyb3JTdGFjazogZGF0YS5lcnJvclN0YWNrLFxuICAgICAgcGhhc2U6IGRhdGEucGhhc2UsIC8vICdBTkFMWVNJUycsICdDT0RFX0dFTkVSQVRJT04nLCAnU0VDVVJJVFknLCAnR0lUJywgZXRjXG4gICAgICBzdGF0dXM6ICdGQUlMRUQnLFxuICAgICAgZGV0YWlsczoge1xuICAgICAgICByZWNvdmVyeUF0dGVtcHRlZDogZGF0YS5yZWNvdmVyeUF0dGVtcHRlZCB8fCBmYWxzZSxcbiAgICAgICAgcmVjb3ZlcnlTdWNjZXNzZnVsOiBkYXRhLnJlY292ZXJ5U3VjY2Vzc2Z1bCB8fCBmYWxzZSxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHRoaXMuYWRkTG9nKGxvZyk7XG4gICAgcmV0dXJuIGxvZy5pZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgZGUgY29uY2x1c8OjbyBkZSBhdXRvbWHDp8Ojb1xuICAgKi9cbiAgbG9nQXV0b21hdGlvbkNvbXBsZXRpb24oZGF0YSkge1xuICAgIGNvbnN0IGxvZyA9IHtcbiAgICAgIGlkOiB0aGlzLmdlbmVyYXRlTG9nSWQoKSxcbiAgICAgIHR5cGU6ICdBVVRPTUFUSU9OX0NPTVBMRVRJT04nLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBhdXRvbWF0aW9uSWQ6IGRhdGEuYXV0b21hdGlvbklkLFxuICAgICAgdXNlcklkOiBkYXRhLnVzZXJJZCxcbiAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsIC8vICdTVUNDRVNTJyBvdSAnRkFJTEVEJ1xuICAgICAgdG90YWxEdXJhdGlvbjogZGF0YS50b3RhbER1cmF0aW9uLFxuICAgICAgY29tbWl0SGFzaDogZGF0YS5jb21taXRIYXNoLFxuICAgICAgcHJVcmw6IGRhdGEucHJVcmwsXG4gICAgICBzdW1tYXJ5OiB7XG4gICAgICAgIGZpbGVzQ3JlYXRlZDogZGF0YS5maWxlc0NyZWF0ZWQgfHwgMCxcbiAgICAgICAgZmlsZXNNb2RpZmllZDogZGF0YS5maWxlc01vZGlmaWVkIHx8IDAsXG4gICAgICAgIGZpbGVzRGVsZXRlZDogZGF0YS5maWxlc0RlbGV0ZWQgfHwgMCxcbiAgICAgICAgbGluZXNBZGRlZDogZGF0YS5saW5lc0FkZGVkIHx8IDAsXG4gICAgICAgIGxpbmVzUmVtb3ZlZDogZGF0YS5saW5lc1JlbW92ZWQgfHwgMCxcbiAgICAgIH0sXG4gICAgICBkZXRhaWxzOiB7XG4gICAgICAgIHNwZWNpYWxpc3Q6IGRhdGEuc3BlY2lhbGlzdCxcbiAgICAgICAgbW9kZTogZGF0YS5tb2RlLFxuICAgICAgICBjcmVkaXRzVXNlZDogZGF0YS5jcmVkaXRzVXNlZCxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHRoaXMuYWRkTG9nKGxvZyk7XG4gICAgcmV0dXJuIGxvZy5pZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2cgZGUgYcOnw6NvIG1hbnVhbCBkbyB1c3XDoXJpb1xuICAgKi9cbiAgbG9nTWFudWFsQWN0aW9uKGRhdGEpIHtcbiAgICBjb25zdCBsb2cgPSB7XG4gICAgICBpZDogdGhpcy5nZW5lcmF0ZUxvZ0lkKCksXG4gICAgICB0eXBlOiAnTUFOVUFMX0FDVElPTicsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHVzZXJJZDogZGF0YS51c2VySWQsXG4gICAgICB1c2VybmFtZTogZGF0YS51c2VybmFtZSxcbiAgICAgIGFjdGlvbjogZGF0YS5hY3Rpb24sIC8vICdFRElUJywgJ1JFVklFVycsICdBUFBST1ZFJywgJ1JFSkVDVCcsIGV0Y1xuICAgICAgdGFyZ2V0RmlsZTogZGF0YS50YXJnZXRGaWxlLFxuICAgICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXG4gICAgICBzdGF0dXM6ICdDT01QTEVURUQnLFxuICAgICAgZGV0YWlsczoge1xuICAgICAgICBpcEFkZHJlc3M6IGRhdGEuaXBBZGRyZXNzLFxuICAgICAgICBzZXNzaW9uSWQ6IGRhdGEuc2Vzc2lvbklkLFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgdGhpcy5hZGRMb2cobG9nKTtcbiAgICByZXR1cm4gbG9nLmlkO1xuICB9XG5cbiAgLyoqXG4gICAqIExvZyBkZSBhY2Vzc28gYW8gcmVwb3NpdMOzcmlvXG4gICAqL1xuICBsb2dSZXBvc2l0b3J5QWNjZXNzKGRhdGEpIHtcbiAgICBjb25zdCBsb2cgPSB7XG4gICAgICBpZDogdGhpcy5nZW5lcmF0ZUxvZ0lkKCksXG4gICAgICB0eXBlOiAnUkVQT1NJVE9SWV9BQ0NFU1MnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxuICAgICAgYWN0aW9uOiBkYXRhLmFjdGlvbiwgLy8gJ1JFQUQnLCAnV1JJVEUnLCAnREVMRVRFJywgZXRjXG4gICAgICByZXBvc2l0b3J5OiBkYXRhLnJlcG9zaXRvcnksXG4gICAgICBicmFuY2g6IGRhdGEuYnJhbmNoLFxuICAgICAgZmlsZXNBY2Nlc3NlZDogZGF0YS5maWxlc0FjY2Vzc2VkLFxuICAgICAgc3RhdHVzOiAnQ09NUExFVEVEJyxcbiAgICAgIGRldGFpbHM6IHtcbiAgICAgICAgaXBBZGRyZXNzOiBkYXRhLmlwQWRkcmVzcyxcbiAgICAgICAgdXNlckFnZW50OiBkYXRhLnVzZXJBZ2VudCxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHRoaXMuYWRkTG9nKGxvZyk7XG4gICAgcmV0dXJuIGxvZy5pZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGljaW9uYXIgbG9nIMOgIGZpbGFcbiAgICovXG4gIGFkZExvZyhsb2cpIHtcbiAgICB0aGlzLmxvZ3MucHVzaChsb2cpO1xuXG4gICAgLy8gTWFudGVyIGxpbWl0ZSBkZSBsb2dzIGVtIG1lbcOzcmlhXG4gICAgaWYgKHRoaXMubG9ncy5sZW5ndGggPiB0aGlzLm1heExvZ3MpIHtcbiAgICAgIHRoaXMubG9ncyA9IHRoaXMubG9ncy5zbGljZSgtdGhpcy5tYXhMb2dzKTtcbiAgICB9XG5cbiAgICAvLyBFbnZpYXIgcGFyYSBzZXJ2aWRvciAoYXN5bmMpXG4gICAgdGhpcy5wZXJzaXN0TG9nKGxvZykuY2F0Y2goZXJyID0+IFxuICAgICAgY29uc29sZS5lcnJvcignRXJybyBhbyBwZXJzaXN0aXIgbG9nOicsIGVycilcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcnNpc3RpciBsb2cgbm8gc2Vydmlkb3JcbiAgICovXG4gIGFzeW5jIHBlcnNpc3RMb2cobG9nKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvYXVkaXQtbG9nJywge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGxvZyksXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvIGFvIHBlcnNpc3RpciBsb2c6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJybyBhbyBlbnZpYXIgbG9nOicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2VyYXIgSUQgw7puaWNvIHBhcmEgbG9nXG4gICAqL1xuICBnZW5lcmF0ZUxvZ0lkKCkge1xuICAgIHJldHVybiBgTE9HXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdXNjYXIgbG9ncyBwb3IgZmlsdHJvc1xuICAgKi9cbiAgc2VhcmNoTG9ncyhmaWx0ZXJzKSB7XG4gICAgbGV0IHJlc3VsdHMgPSB0aGlzLmxvZ3M7XG5cbiAgICBpZiAoZmlsdGVycy50eXBlKSB7XG4gICAgICByZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIobG9nID0+IGxvZy50eXBlID09PSBmaWx0ZXJzLnR5cGUpO1xuICAgIH1cblxuICAgIGlmIChmaWx0ZXJzLnVzZXJJZCkge1xuICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKGxvZyA9PiBsb2cudXNlcklkID09PSBmaWx0ZXJzLnVzZXJJZCk7XG4gICAgfVxuXG4gICAgaWYgKGZpbHRlcnMuc3RhdHVzKSB7XG4gICAgICByZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIobG9nID0+IGxvZy5zdGF0dXMgPT09IGZpbHRlcnMuc3RhdHVzKTtcbiAgICB9XG5cbiAgICBpZiAoZmlsdGVycy5zdGFydERhdGUpIHtcbiAgICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoZmlsdGVycy5zdGFydERhdGUpO1xuICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKGxvZyA9PiBuZXcgRGF0ZShsb2cudGltZXN0YW1wKSA+PSBzdGFydCk7XG4gICAgfVxuXG4gICAgaWYgKGZpbHRlcnMuZW5kRGF0ZSkge1xuICAgICAgY29uc3QgZW5kID0gbmV3IERhdGUoZmlsdGVycy5lbmREYXRlKTtcbiAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihsb2cgPT4gbmV3IERhdGUobG9nLnRpbWVzdGFtcCkgPD0gZW5kKTtcbiAgICB9XG5cbiAgICBpZiAoZmlsdGVycy5hdXRvbWF0aW9uSWQpIHtcbiAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihsb2cgPT4gbG9nLmF1dG9tYXRpb25JZCA9PT0gZmlsdGVycy5hdXRvbWF0aW9uSWQpO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlcmFyIHJlbGF0w7NyaW8gZGUgYXVkaXRvcmlhXG4gICAqL1xuICBnZW5lcmF0ZUF1ZGl0UmVwb3J0KGZpbHRlcnMgPSB7fSkge1xuICAgIGNvbnN0IGxvZ3MgPSB0aGlzLnNlYXJjaExvZ3MoZmlsdGVycyk7XG5cbiAgICBjb25zdCByZXBvcnQgPSB7XG4gICAgICBnZW5lcmF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgZmlsdGVycyxcbiAgICAgIHN1bW1hcnk6IHtcbiAgICAgICAgdG90YWxMb2dzOiBsb2dzLmxlbmd0aCxcbiAgICAgICAgYnlUeXBlOiB7fSxcbiAgICAgICAgYnlTdGF0dXM6IHt9LFxuICAgICAgICBieVVzZXI6IHt9LFxuICAgICAgfSxcbiAgICAgIGRldGFpbHM6IGxvZ3MsXG4gICAgfTtcblxuICAgIC8vIENvbnRhciBwb3IgdGlwb1xuICAgIGxvZ3MuZm9yRWFjaChsb2cgPT4ge1xuICAgICAgcmVwb3J0LnN1bW1hcnkuYnlUeXBlW2xvZy50eXBlXSA9IChyZXBvcnQuc3VtbWFyeS5ieVR5cGVbbG9nLnR5cGVdIHx8IDApICsgMTtcbiAgICAgIHJlcG9ydC5zdW1tYXJ5LmJ5U3RhdHVzW2xvZy5zdGF0dXNdID0gKHJlcG9ydC5zdW1tYXJ5LmJ5U3RhdHVzW2xvZy5zdGF0dXNdIHx8IDApICsgMTtcbiAgICAgIHJlcG9ydC5zdW1tYXJ5LmJ5VXNlcltsb2cudXNlcklkXSA9IChyZXBvcnQuc3VtbWFyeS5ieVVzZXJbbG9nLnVzZXJJZF0gfHwgMCkgKyAxO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlcG9ydDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHBvcnRhciBsb2dzIGVtIEpTT05cbiAgICovXG4gIGV4cG9ydExvZ3MoZmlsdGVycyA9IHt9KSB7XG4gICAgY29uc3QgbG9ncyA9IHRoaXMuc2VhcmNoTG9ncyhmaWx0ZXJzKTtcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobG9ncywgbnVsbCwgMik7XG4gIH1cblxuICAvKipcbiAgICogRXhwb3J0YXIgbG9ncyBlbSBDU1ZcbiAgICovXG4gIGV4cG9ydExvZ3NDU1YoZmlsdGVycyA9IHt9KSB7XG4gICAgY29uc3QgbG9ncyA9IHRoaXMuc2VhcmNoTG9ncyhmaWx0ZXJzKTtcbiAgICBcbiAgICBpZiAobG9ncy5sZW5ndGggPT09IDApIHJldHVybiAnJztcblxuICAgIC8vIEhlYWRlcnNcbiAgICBjb25zdCBoZWFkZXJzID0gT2JqZWN0LmtleXMobG9nc1swXSk7XG4gICAgY29uc3QgY3N2ID0gW2hlYWRlcnMuam9pbignLCcpXTtcblxuICAgIC8vIFJvd3NcbiAgICBsb2dzLmZvckVhY2gobG9nID0+IHtcbiAgICAgIGNvbnN0IHJvdyA9IGhlYWRlcnMubWFwKGhlYWRlciA9PiB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gbG9nW2hlYWRlcl07XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgcmV0dXJuIGBcIiR7SlNPTi5zdHJpbmdpZnkodmFsdWUpLnJlcGxhY2UoL1wiL2csICdcIlwiJyl9XCJgO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgXCIke1N0cmluZyh2YWx1ZSkucmVwbGFjZSgvXCIvZywgJ1wiXCInKX1cImA7XG4gICAgICB9KTtcbiAgICAgIGNzdi5wdXNoKHJvdy5qb2luKCcsJykpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNzdi5qb2luKCdcXG4nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMaW1wYXIgbG9ncyBhbnRpZ29zXG4gICAqL1xuICBjbGVhck9sZExvZ3MoZGF5c1RvS2VlcCA9IDMwKSB7XG4gICAgY29uc3QgY3V0b2ZmRGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgY3V0b2ZmRGF0ZS5zZXREYXRlKGN1dG9mZkRhdGUuZ2V0RGF0ZSgpIC0gZGF5c1RvS2VlcCk7XG5cbiAgICBjb25zdCBiZWZvcmVDb3VudCA9IHRoaXMubG9ncy5sZW5ndGg7XG4gICAgdGhpcy5sb2dzID0gdGhpcy5sb2dzLmZpbHRlcihsb2cgPT4gXG4gICAgICBuZXcgRGF0ZShsb2cudGltZXN0YW1wKSA+IGN1dG9mZkRhdGVcbiAgICApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxvZ3NSZW1vdmVkOiBiZWZvcmVDb3VudCAtIHRoaXMubG9ncy5sZW5ndGgsXG4gICAgICBsb2dzUmVtYWluaW5nOiB0aGlzLmxvZ3MubGVuZ3RoLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogT2J0ZXIgZXN0YXTDrXN0aWNhc1xuICAgKi9cbiAgZ2V0U3RhdGlzdGljcygpIHtcbiAgICBjb25zdCBzdGF0cyA9IHtcbiAgICAgIHRvdGFsTG9nczogdGhpcy5sb2dzLmxlbmd0aCxcbiAgICAgIGxvZ1R5cGVzOiB7fSxcbiAgICAgIHN0YXR1c0NvdW50czoge30sXG4gICAgICB1c2VyQWN0aXZpdHk6IHt9LFxuICAgICAgdGltZVJhbmdlOiB7XG4gICAgICAgIG9sZGVzdDogdGhpcy5sb2dzLmxlbmd0aCA+IDAgPyB0aGlzLmxvZ3NbMF0udGltZXN0YW1wIDogbnVsbCxcbiAgICAgICAgbmV3ZXN0OiB0aGlzLmxvZ3MubGVuZ3RoID4gMCA/IHRoaXMubG9nc1t0aGlzLmxvZ3MubGVuZ3RoIC0gMV0udGltZXN0YW1wIDogbnVsbCxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIHRoaXMubG9ncy5mb3JFYWNoKGxvZyA9PiB7XG4gICAgICBzdGF0cy5sb2dUeXBlc1tsb2cudHlwZV0gPSAoc3RhdHMubG9nVHlwZXNbbG9nLnR5cGVdIHx8IDApICsgMTtcbiAgICAgIHN0YXRzLnN0YXR1c0NvdW50c1tsb2cuc3RhdHVzXSA9IChzdGF0cy5zdGF0dXNDb3VudHNbbG9nLnN0YXR1c10gfHwgMCkgKyAxO1xuICAgICAgXG4gICAgICBpZiAobG9nLnVzZXJJZCkge1xuICAgICAgICBzdGF0cy51c2VyQWN0aXZpdHlbbG9nLnVzZXJJZF0gPSAoc3RhdHMudXNlckFjdGl2aXR5W2xvZy51c2VySWRdIHx8IDApICsgMTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBzdGF0cztcbiAgfVxufVxuXG4vLyBFeHBvcnRhclxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gIG1vZHVsZS5leHBvcnRzID0gQXVkaXRMb2dnZXI7XG59XG5cbmV4cG9ydCBkZWZhdWx0IEF1ZGl0TG9nZ2VyO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU1BLFdBQVcsQ0FBQztFQUNoQkMsV0FBV0EsQ0FBQSxFQUFHO0lBQ1osSUFBSSxDQUFDQyxJQUFJLEdBQUcsRUFBRTtJQUNkLElBQUksQ0FBQ0MsT0FBTyxHQUFHLEtBQUssQ0FBQyxDQUFDO0VBQ3hCOztFQUVBO0FBQ0Y7QUFDQTtFQUNFQyxvQkFBb0JBLENBQUNDLElBQUksRUFBRTtJQUN6QixNQUFNQyxHQUFHLEdBQUc7TUFDVkMsRUFBRSxFQUFFLElBQUksQ0FBQ0MsYUFBYSxDQUFDLENBQUM7TUFDeEJDLElBQUksRUFBRSxvQkFBb0I7TUFDMUJDLFNBQVMsRUFBRSxJQUFJQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxXQUFXLENBQUMsQ0FBQztNQUNuQ0MsTUFBTSxFQUFFUixJQUFJLENBQUNRLE1BQU07TUFDbkJDLFFBQVEsRUFBRVQsSUFBSSxDQUFDUyxRQUFRO01BQ3ZCQyxPQUFPLEVBQUVWLElBQUksQ0FBQ1UsT0FBTztNQUNyQkMsSUFBSSxFQUFFWCxJQUFJLENBQUNXLElBQUk7TUFBRTtNQUNqQkMsa0JBQWtCLEVBQUVaLElBQUksQ0FBQ1ksa0JBQWtCO01BQzNDQyxtQkFBbUIsRUFBRWIsSUFBSSxDQUFDYSxtQkFBbUI7TUFDN0NDLFdBQVcsRUFBRWQsSUFBSSxDQUFDYyxXQUFXO01BQzdCQyxNQUFNLEVBQUUsV0FBVztNQUNuQkMsT0FBTyxFQUFFO1FBQ1BDLFNBQVMsRUFBRWpCLElBQUksQ0FBQ2lCLFNBQVM7UUFDekJDLFNBQVMsRUFBRWxCLElBQUksQ0FBQ2tCLFNBQVM7UUFDekJDLFNBQVMsRUFBRW5CLElBQUksQ0FBQ21CO01BQ2xCO0lBQ0YsQ0FBQztJQUVELElBQUksQ0FBQ0MsTUFBTSxDQUFDbkIsR0FBRyxDQUFDO0lBQ2hCLE9BQU9BLEdBQUcsQ0FBQ0MsRUFBRTtFQUNmOztFQUVBO0FBQ0Y7QUFDQTtFQUNFbUIsZUFBZUEsQ0FBQ3JCLElBQUksRUFBRTtJQUNwQixNQUFNQyxHQUFHLEdBQUc7TUFDVkMsRUFBRSxFQUFFLElBQUksQ0FBQ0MsYUFBYSxDQUFDLENBQUM7TUFDeEJDLElBQUksRUFBRSxlQUFlO01BQ3JCQyxTQUFTLEVBQUUsSUFBSUMsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUM7TUFDbkNlLFlBQVksRUFBRXRCLElBQUksQ0FBQ3NCLFlBQVk7TUFDL0JDLFVBQVUsRUFBRXZCLElBQUksQ0FBQ3VCLFVBQVU7TUFDM0JDLGFBQWEsRUFBRXhCLElBQUksQ0FBQ3dCLGFBQWE7TUFDakNDLGFBQWEsRUFBRXpCLElBQUksQ0FBQ3lCLGFBQWE7TUFDakNDLFdBQVcsRUFBRTFCLElBQUksQ0FBQzBCLFdBQVc7TUFDN0JYLE1BQU0sRUFBRSxXQUFXO01BQ25CQyxPQUFPLEVBQUU7UUFDUFcsWUFBWSxFQUFFM0IsSUFBSSxDQUFDMkIsWUFBWTtRQUMvQkMsS0FBSyxFQUFFNUIsSUFBSSxDQUFDNEIsS0FBSztRQUNqQkMsV0FBVyxFQUFFN0IsSUFBSSxDQUFDNkI7TUFDcEI7SUFDRixDQUFDO0lBRUQsSUFBSSxDQUFDVCxNQUFNLENBQUNuQixHQUFHLENBQUM7SUFDaEIsT0FBT0EsR0FBRyxDQUFDQyxFQUFFO0VBQ2Y7O0VBRUE7QUFDRjtBQUNBO0VBQ0U0QixxQkFBcUJBLENBQUM5QixJQUFJLEVBQUU7SUFDMUIsTUFBTUMsR0FBRyxHQUFHO01BQ1ZDLEVBQUUsRUFBRSxJQUFJLENBQUNDLGFBQWEsQ0FBQyxDQUFDO01BQ3hCQyxJQUFJLEVBQUUscUJBQXFCO01BQzNCQyxTQUFTLEVBQUUsSUFBSUMsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUM7TUFDbkNlLFlBQVksRUFBRXRCLElBQUksQ0FBQ3NCLFlBQVk7TUFDL0JTLFlBQVksRUFBRS9CLElBQUksQ0FBQytCLFlBQVk7TUFDL0JoQixNQUFNLEVBQUVmLElBQUksQ0FBQ2dDLE9BQU8sR0FBRyxRQUFRLEdBQUcsU0FBUztNQUMzQ0MsUUFBUSxFQUFFakMsSUFBSSxDQUFDaUMsUUFBUTtNQUN2QkMsTUFBTSxFQUFFbEMsSUFBSSxDQUFDa0MsTUFBTSxJQUFJLEVBQUU7TUFDekJDLFFBQVEsRUFBRW5DLElBQUksQ0FBQ21DLFFBQVEsSUFBSSxFQUFFO01BQzdCbkIsT0FBTyxFQUFFO1FBQ1BvQixjQUFjLEVBQUVwQyxJQUFJLENBQUNvQyxjQUFjO1FBQ25DQyxlQUFlLEVBQUVyQyxJQUFJLENBQUNxQyxlQUFlLElBQUksRUFBRTtRQUMzQ0MsZ0JBQWdCLEVBQUV0QyxJQUFJLENBQUNzQyxnQkFBZ0IsSUFBSTtNQUM3QztJQUNGLENBQUM7SUFFRCxJQUFJLENBQUNsQixNQUFNLENBQUNuQixHQUFHLENBQUM7SUFDaEIsT0FBT0EsR0FBRyxDQUFDQyxFQUFFO0VBQ2Y7O0VBRUE7QUFDRjtBQUNBO0VBQ0VxQyxZQUFZQSxDQUFDdkMsSUFBSSxFQUFFO0lBQ2pCLE1BQU1DLEdBQUcsR0FBRztNQUNWQyxFQUFFLEVBQUUsSUFBSSxDQUFDQyxhQUFhLENBQUMsQ0FBQztNQUN4QkMsSUFBSSxFQUFFLFlBQVk7TUFDbEJDLFNBQVMsRUFBRSxJQUFJQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxXQUFXLENBQUMsQ0FBQztNQUNuQ2UsWUFBWSxFQUFFdEIsSUFBSSxDQUFDc0IsWUFBWTtNQUMvQmtCLFVBQVUsRUFBRXhDLElBQUksQ0FBQ3dDLFVBQVU7TUFDM0JDLGFBQWEsRUFBRXpDLElBQUksQ0FBQ3lDLGFBQWE7TUFDakNDLE1BQU0sRUFBRTFDLElBQUksQ0FBQzBDLE1BQU07TUFDbkJDLFlBQVksRUFBRTNDLElBQUksQ0FBQzJDLFlBQVk7TUFDL0JDLFVBQVUsRUFBRTVDLElBQUksQ0FBQzRDLFVBQVU7TUFDM0JDLFNBQVMsRUFBRTdDLElBQUksQ0FBQzZDLFNBQVM7TUFDekI5QixNQUFNLEVBQUUsV0FBVztNQUNuQkMsT0FBTyxFQUFFO1FBQ1A4QixNQUFNLEVBQUU5QyxJQUFJLENBQUM4QyxNQUFNO1FBQ25CQyxRQUFRLEVBQUUvQyxJQUFJLENBQUMrQyxRQUFRO1FBQ3ZCQyxTQUFTLEVBQUVoRCxJQUFJLENBQUNnRCxTQUFTLElBQUksS0FBSztRQUNsQ0MsUUFBUSxFQUFFakQsSUFBSSxDQUFDaUQsUUFBUSxJQUFJO01BQzdCO0lBQ0YsQ0FBQztJQUVELElBQUksQ0FBQzdCLE1BQU0sQ0FBQ25CLEdBQUcsQ0FBQztJQUNoQixPQUFPQSxHQUFHLENBQUNDLEVBQUU7RUFDZjs7RUFFQTtBQUNGO0FBQ0E7RUFDRWdELGNBQWNBLENBQUNsRCxJQUFJLEVBQUU7SUFDbkIsTUFBTUMsR0FBRyxHQUFHO01BQ1ZDLEVBQUUsRUFBRSxJQUFJLENBQUNDLGFBQWEsQ0FBQyxDQUFDO01BQ3hCQyxJQUFJLEVBQUUsY0FBYztNQUNwQkMsU0FBUyxFQUFFLElBQUlDLElBQUksQ0FBQyxDQUFDLENBQUNDLFdBQVcsQ0FBQyxDQUFDO01BQ25DQyxNQUFNLEVBQUVSLElBQUksQ0FBQ1EsTUFBTTtNQUNuQmMsWUFBWSxFQUFFdEIsSUFBSSxDQUFDc0IsWUFBWTtNQUMvQjZCLGVBQWUsRUFBRW5ELElBQUksQ0FBQ21ELGVBQWU7TUFDckNDLGdCQUFnQixFQUFFcEQsSUFBSSxDQUFDb0QsZ0JBQWdCO01BQ3ZDekMsSUFBSSxFQUFFWCxJQUFJLENBQUNXLElBQUk7TUFDZjBDLFNBQVMsRUFBRTtRQUNUQyxRQUFRLEVBQUV0RCxJQUFJLENBQUNxRCxTQUFTLEVBQUVDLFFBQVEsSUFBSSxDQUFDO1FBQ3ZDQyxjQUFjLEVBQUV2RCxJQUFJLENBQUNxRCxTQUFTLEVBQUVFLGNBQWMsSUFBSSxDQUFDO1FBQ25EQyxrQkFBa0IsRUFBRXhELElBQUksQ0FBQ3FELFNBQVMsRUFBRUcsa0JBQWtCLElBQUksQ0FBQztRQUMzREMsYUFBYSxFQUFFekQsSUFBSSxDQUFDcUQsU0FBUyxFQUFFSSxhQUFhLElBQUk7TUFDbEQsQ0FBQztNQUNEMUMsTUFBTSxFQUFFO0lBQ1YsQ0FBQztJQUVELElBQUksQ0FBQ0ssTUFBTSxDQUFDbkIsR0FBRyxDQUFDO0lBQ2hCLE9BQU9BLEdBQUcsQ0FBQ0MsRUFBRTtFQUNmOztFQUVBO0FBQ0Y7QUFDQTtFQUNFd0QsUUFBUUEsQ0FBQzFELElBQUksRUFBRTtJQUNiLE1BQU1DLEdBQUcsR0FBRztNQUNWQyxFQUFFLEVBQUUsSUFBSSxDQUFDQyxhQUFhLENBQUMsQ0FBQztNQUN4QkMsSUFBSSxFQUFFLE9BQU87TUFDYkMsU0FBUyxFQUFFLElBQUlDLElBQUksQ0FBQyxDQUFDLENBQUNDLFdBQVcsQ0FBQyxDQUFDO01BQ25DZSxZQUFZLEVBQUV0QixJQUFJLENBQUNzQixZQUFZO01BQy9CZCxNQUFNLEVBQUVSLElBQUksQ0FBQ1EsTUFBTTtNQUNuQm1ELFNBQVMsRUFBRTNELElBQUksQ0FBQzJELFNBQVM7TUFDekJDLFlBQVksRUFBRTVELElBQUksQ0FBQzRELFlBQVk7TUFDL0JDLFVBQVUsRUFBRTdELElBQUksQ0FBQzZELFVBQVU7TUFDM0JDLEtBQUssRUFBRTlELElBQUksQ0FBQzhELEtBQUs7TUFBRTtNQUNuQi9DLE1BQU0sRUFBRSxRQUFRO01BQ2hCQyxPQUFPLEVBQUU7UUFDUCtDLGlCQUFpQixFQUFFL0QsSUFBSSxDQUFDK0QsaUJBQWlCLElBQUksS0FBSztRQUNsREMsa0JBQWtCLEVBQUVoRSxJQUFJLENBQUNnRSxrQkFBa0IsSUFBSTtNQUNqRDtJQUNGLENBQUM7SUFFRCxJQUFJLENBQUM1QyxNQUFNLENBQUNuQixHQUFHLENBQUM7SUFDaEIsT0FBT0EsR0FBRyxDQUFDQyxFQUFFO0VBQ2Y7O0VBRUE7QUFDRjtBQUNBO0VBQ0UrRCx1QkFBdUJBLENBQUNqRSxJQUFJLEVBQUU7SUFDNUIsTUFBTUMsR0FBRyxHQUFHO01BQ1ZDLEVBQUUsRUFBRSxJQUFJLENBQUNDLGFBQWEsQ0FBQyxDQUFDO01BQ3hCQyxJQUFJLEVBQUUsdUJBQXVCO01BQzdCQyxTQUFTLEVBQUUsSUFBSUMsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUM7TUFDbkNlLFlBQVksRUFBRXRCLElBQUksQ0FBQ3NCLFlBQVk7TUFDL0JkLE1BQU0sRUFBRVIsSUFBSSxDQUFDUSxNQUFNO01BQ25CTyxNQUFNLEVBQUVmLElBQUksQ0FBQ2UsTUFBTTtNQUFFO01BQ3JCbUQsYUFBYSxFQUFFbEUsSUFBSSxDQUFDa0UsYUFBYTtNQUNqQzFCLFVBQVUsRUFBRXhDLElBQUksQ0FBQ3dDLFVBQVU7TUFDM0IyQixLQUFLLEVBQUVuRSxJQUFJLENBQUNtRSxLQUFLO01BQ2pCQyxPQUFPLEVBQUU7UUFDUEMsWUFBWSxFQUFFckUsSUFBSSxDQUFDcUUsWUFBWSxJQUFJLENBQUM7UUFDcENDLGFBQWEsRUFBRXRFLElBQUksQ0FBQ3NFLGFBQWEsSUFBSSxDQUFDO1FBQ3RDQyxZQUFZLEVBQUV2RSxJQUFJLENBQUN1RSxZQUFZLElBQUksQ0FBQztRQUNwQ0MsVUFBVSxFQUFFeEUsSUFBSSxDQUFDd0UsVUFBVSxJQUFJLENBQUM7UUFDaENDLFlBQVksRUFBRXpFLElBQUksQ0FBQ3lFLFlBQVksSUFBSTtNQUNyQyxDQUFDO01BQ0R6RCxPQUFPLEVBQUU7UUFDUE8sVUFBVSxFQUFFdkIsSUFBSSxDQUFDdUIsVUFBVTtRQUMzQlosSUFBSSxFQUFFWCxJQUFJLENBQUNXLElBQUk7UUFDZitELFdBQVcsRUFBRTFFLElBQUksQ0FBQzBFO01BQ3BCO0lBQ0YsQ0FBQztJQUVELElBQUksQ0FBQ3RELE1BQU0sQ0FBQ25CLEdBQUcsQ0FBQztJQUNoQixPQUFPQSxHQUFHLENBQUNDLEVBQUU7RUFDZjs7RUFFQTtBQUNGO0FBQ0E7RUFDRXlFLGVBQWVBLENBQUMzRSxJQUFJLEVBQUU7SUFDcEIsTUFBTUMsR0FBRyxHQUFHO01BQ1ZDLEVBQUUsRUFBRSxJQUFJLENBQUNDLGFBQWEsQ0FBQyxDQUFDO01BQ3hCQyxJQUFJLEVBQUUsZUFBZTtNQUNyQkMsU0FBUyxFQUFFLElBQUlDLElBQUksQ0FBQyxDQUFDLENBQUNDLFdBQVcsQ0FBQyxDQUFDO01BQ25DQyxNQUFNLEVBQUVSLElBQUksQ0FBQ1EsTUFBTTtNQUNuQkMsUUFBUSxFQUFFVCxJQUFJLENBQUNTLFFBQVE7TUFDdkJtRSxNQUFNLEVBQUU1RSxJQUFJLENBQUM0RSxNQUFNO01BQUU7TUFDckJDLFVBQVUsRUFBRTdFLElBQUksQ0FBQzZFLFVBQVU7TUFDM0IvRCxXQUFXLEVBQUVkLElBQUksQ0FBQ2MsV0FBVztNQUM3QkMsTUFBTSxFQUFFLFdBQVc7TUFDbkJDLE9BQU8sRUFBRTtRQUNQQyxTQUFTLEVBQUVqQixJQUFJLENBQUNpQixTQUFTO1FBQ3pCRSxTQUFTLEVBQUVuQixJQUFJLENBQUNtQjtNQUNsQjtJQUNGLENBQUM7SUFFRCxJQUFJLENBQUNDLE1BQU0sQ0FBQ25CLEdBQUcsQ0FBQztJQUNoQixPQUFPQSxHQUFHLENBQUNDLEVBQUU7RUFDZjs7RUFFQTtBQUNGO0FBQ0E7RUFDRTRFLG1CQUFtQkEsQ0FBQzlFLElBQUksRUFBRTtJQUN4QixNQUFNQyxHQUFHLEdBQUc7TUFDVkMsRUFBRSxFQUFFLElBQUksQ0FBQ0MsYUFBYSxDQUFDLENBQUM7TUFDeEJDLElBQUksRUFBRSxtQkFBbUI7TUFDekJDLFNBQVMsRUFBRSxJQUFJQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxXQUFXLENBQUMsQ0FBQztNQUNuQ0MsTUFBTSxFQUFFUixJQUFJLENBQUNRLE1BQU07TUFDbkJvRSxNQUFNLEVBQUU1RSxJQUFJLENBQUM0RSxNQUFNO01BQUU7TUFDckJHLFVBQVUsRUFBRS9FLElBQUksQ0FBQytFLFVBQVU7TUFDM0JyQyxNQUFNLEVBQUUxQyxJQUFJLENBQUMwQyxNQUFNO01BQ25Cc0MsYUFBYSxFQUFFaEYsSUFBSSxDQUFDZ0YsYUFBYTtNQUNqQ2pFLE1BQU0sRUFBRSxXQUFXO01BQ25CQyxPQUFPLEVBQUU7UUFDUEMsU0FBUyxFQUFFakIsSUFBSSxDQUFDaUIsU0FBUztRQUN6QkMsU0FBUyxFQUFFbEIsSUFBSSxDQUFDa0I7TUFDbEI7SUFDRixDQUFDO0lBRUQsSUFBSSxDQUFDRSxNQUFNLENBQUNuQixHQUFHLENBQUM7SUFDaEIsT0FBT0EsR0FBRyxDQUFDQyxFQUFFO0VBQ2Y7O0VBRUE7QUFDRjtBQUNBO0VBQ0VrQixNQUFNQSxDQUFDbkIsR0FBRyxFQUFFO0lBQ1YsSUFBSSxDQUFDSixJQUFJLENBQUNvRixJQUFJLENBQUNoRixHQUFHLENBQUM7O0lBRW5CO0lBQ0EsSUFBSSxJQUFJLENBQUNKLElBQUksQ0FBQ3FGLE1BQU0sR0FBRyxJQUFJLENBQUNwRixPQUFPLEVBQUU7TUFDbkMsSUFBSSxDQUFDRCxJQUFJLEdBQUcsSUFBSSxDQUFDQSxJQUFJLENBQUNzRixLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUNyRixPQUFPLENBQUM7SUFDNUM7O0lBRUE7SUFDQSxJQUFJLENBQUNzRixVQUFVLENBQUNuRixHQUFHLENBQUMsQ0FBQ29GLEtBQUssQ0FBQ0MsR0FBRyxJQUM1QkMsT0FBTyxDQUFDQyxLQUFLLENBQUMsd0JBQXdCLEVBQUVGLEdBQUcsQ0FDN0MsQ0FBQztFQUNIOztFQUVBO0FBQ0Y7QUFDQTtFQUNFLE1BQU1GLFVBQVVBLENBQUNuRixHQUFHLEVBQUU7SUFDcEIsSUFBSTtNQUNGLE1BQU13RixRQUFRLEdBQUcsTUFBTUMsS0FBSyxDQUFDLGdCQUFnQixFQUFFO1FBQzdDQyxNQUFNLEVBQUUsTUFBTTtRQUNkQyxPQUFPLEVBQUU7VUFBRSxjQUFjLEVBQUU7UUFBbUIsQ0FBQztRQUMvQ0MsSUFBSSxFQUFFQyxJQUFJLENBQUNDLFNBQVMsQ0FBQzlGLEdBQUc7TUFDMUIsQ0FBQyxDQUFDO01BRUYsSUFBSSxDQUFDd0YsUUFBUSxDQUFDTyxFQUFFLEVBQUU7UUFDaEJULE9BQU8sQ0FBQ0MsS0FBSyxDQUFDLHdCQUF3QixFQUFFQyxRQUFRLENBQUMxRSxNQUFNLENBQUM7TUFDMUQ7SUFDRixDQUFDLENBQUMsT0FBT3lFLEtBQUssRUFBRTtNQUNkRCxPQUFPLENBQUNDLEtBQUssQ0FBQyxxQkFBcUIsRUFBRUEsS0FBSyxDQUFDO0lBQzdDO0VBQ0Y7O0VBRUE7QUFDRjtBQUNBO0VBQ0VyRixhQUFhQSxDQUFBLEVBQUc7SUFDZCxPQUFPLE9BQU9HLElBQUksQ0FBQzJGLEdBQUcsQ0FBQyxDQUFDLElBQUlDLElBQUksQ0FBQ0MsTUFBTSxDQUFDLENBQUMsQ0FBQ0MsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0VBQ3ZFOztFQUVBO0FBQ0Y7QUFDQTtFQUNFQyxVQUFVQSxDQUFDQyxPQUFPLEVBQUU7SUFDbEIsSUFBSUMsT0FBTyxHQUFHLElBQUksQ0FBQzNHLElBQUk7SUFFdkIsSUFBSTBHLE9BQU8sQ0FBQ25HLElBQUksRUFBRTtNQUNoQm9HLE9BQU8sR0FBR0EsT0FBTyxDQUFDQyxNQUFNLENBQUN4RyxHQUFHLElBQUlBLEdBQUcsQ0FBQ0csSUFBSSxLQUFLbUcsT0FBTyxDQUFDbkcsSUFBSSxDQUFDO0lBQzVEO0lBRUEsSUFBSW1HLE9BQU8sQ0FBQy9GLE1BQU0sRUFBRTtNQUNsQmdHLE9BQU8sR0FBR0EsT0FBTyxDQUFDQyxNQUFNLENBQUN4RyxHQUFHLElBQUlBLEdBQUcsQ0FBQ08sTUFBTSxLQUFLK0YsT0FBTyxDQUFDL0YsTUFBTSxDQUFDO0lBQ2hFO0lBRUEsSUFBSStGLE9BQU8sQ0FBQ3hGLE1BQU0sRUFBRTtNQUNsQnlGLE9BQU8sR0FBR0EsT0FBTyxDQUFDQyxNQUFNLENBQUN4RyxHQUFHLElBQUlBLEdBQUcsQ0FBQ2MsTUFBTSxLQUFLd0YsT0FBTyxDQUFDeEYsTUFBTSxDQUFDO0lBQ2hFO0lBRUEsSUFBSXdGLE9BQU8sQ0FBQ0csU0FBUyxFQUFFO01BQ3JCLE1BQU1DLEtBQUssR0FBRyxJQUFJckcsSUFBSSxDQUFDaUcsT0FBTyxDQUFDRyxTQUFTLENBQUM7TUFDekNGLE9BQU8sR0FBR0EsT0FBTyxDQUFDQyxNQUFNLENBQUN4RyxHQUFHLElBQUksSUFBSUssSUFBSSxDQUFDTCxHQUFHLENBQUNJLFNBQVMsQ0FBQyxJQUFJc0csS0FBSyxDQUFDO0lBQ25FO0lBRUEsSUFBSUosT0FBTyxDQUFDSyxPQUFPLEVBQUU7TUFDbkIsTUFBTUMsR0FBRyxHQUFHLElBQUl2RyxJQUFJLENBQUNpRyxPQUFPLENBQUNLLE9BQU8sQ0FBQztNQUNyQ0osT0FBTyxHQUFHQSxPQUFPLENBQUNDLE1BQU0sQ0FBQ3hHLEdBQUcsSUFBSSxJQUFJSyxJQUFJLENBQUNMLEdBQUcsQ0FBQ0ksU0FBUyxDQUFDLElBQUl3RyxHQUFHLENBQUM7SUFDakU7SUFFQSxJQUFJTixPQUFPLENBQUNqRixZQUFZLEVBQUU7TUFDeEJrRixPQUFPLEdBQUdBLE9BQU8sQ0FBQ0MsTUFBTSxDQUFDeEcsR0FBRyxJQUFJQSxHQUFHLENBQUNxQixZQUFZLEtBQUtpRixPQUFPLENBQUNqRixZQUFZLENBQUM7SUFDNUU7SUFFQSxPQUFPa0YsT0FBTztFQUNoQjs7RUFFQTtBQUNGO0FBQ0E7RUFDRU0sbUJBQW1CQSxDQUFDUCxPQUFPLEdBQUcsQ0FBQyxDQUFDLEVBQUU7SUFDaEMsTUFBTTFHLElBQUksR0FBRyxJQUFJLENBQUN5RyxVQUFVLENBQUNDLE9BQU8sQ0FBQztJQUVyQyxNQUFNUSxNQUFNLEdBQUc7TUFDYkMsV0FBVyxFQUFFLElBQUkxRyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxXQUFXLENBQUMsQ0FBQztNQUNyQ2dHLE9BQU87TUFDUG5DLE9BQU8sRUFBRTtRQUNQNkMsU0FBUyxFQUFFcEgsSUFBSSxDQUFDcUYsTUFBTTtRQUN0QmdDLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDVkMsUUFBUSxFQUFFLENBQUMsQ0FBQztRQUNaQyxNQUFNLEVBQUUsQ0FBQztNQUNYLENBQUM7TUFDRHBHLE9BQU8sRUFBRW5CO0lBQ1gsQ0FBQzs7SUFFRDtJQUNBQSxJQUFJLENBQUN3SCxPQUFPLENBQUNwSCxHQUFHLElBQUk7TUFDbEI4RyxNQUFNLENBQUMzQyxPQUFPLENBQUM4QyxNQUFNLENBQUNqSCxHQUFHLENBQUNHLElBQUksQ0FBQyxHQUFHLENBQUMyRyxNQUFNLENBQUMzQyxPQUFPLENBQUM4QyxNQUFNLENBQUNqSCxHQUFHLENBQUNHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO01BQzVFMkcsTUFBTSxDQUFDM0MsT0FBTyxDQUFDK0MsUUFBUSxDQUFDbEgsR0FBRyxDQUFDYyxNQUFNLENBQUMsR0FBRyxDQUFDZ0csTUFBTSxDQUFDM0MsT0FBTyxDQUFDK0MsUUFBUSxDQUFDbEgsR0FBRyxDQUFDYyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztNQUNwRmdHLE1BQU0sQ0FBQzNDLE9BQU8sQ0FBQ2dELE1BQU0sQ0FBQ25ILEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQ3VHLE1BQU0sQ0FBQzNDLE9BQU8sQ0FBQ2dELE1BQU0sQ0FBQ25ILEdBQUcsQ0FBQ08sTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDbEYsQ0FBQyxDQUFDO0lBRUYsT0FBT3VHLE1BQU07RUFDZjs7RUFFQTtBQUNGO0FBQ0E7RUFDRU8sVUFBVUEsQ0FBQ2YsT0FBTyxHQUFHLENBQUMsQ0FBQyxFQUFFO0lBQ3ZCLE1BQU0xRyxJQUFJLEdBQUcsSUFBSSxDQUFDeUcsVUFBVSxDQUFDQyxPQUFPLENBQUM7SUFDckMsT0FBT1QsSUFBSSxDQUFDQyxTQUFTLENBQUNsRyxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztFQUN0Qzs7RUFFQTtBQUNGO0FBQ0E7RUFDRTBILGFBQWFBLENBQUNoQixPQUFPLEdBQUcsQ0FBQyxDQUFDLEVBQUU7SUFDMUIsTUFBTTFHLElBQUksR0FBRyxJQUFJLENBQUN5RyxVQUFVLENBQUNDLE9BQU8sQ0FBQztJQUVyQyxJQUFJMUcsSUFBSSxDQUFDcUYsTUFBTSxLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUU7O0lBRWhDO0lBQ0EsTUFBTVUsT0FBTyxHQUFHNEIsTUFBTSxDQUFDQyxJQUFJLENBQUM1SCxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDcEMsTUFBTTZILEdBQUcsR0FBRyxDQUFDOUIsT0FBTyxDQUFDK0IsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDOztJQUUvQjtJQUNBOUgsSUFBSSxDQUFDd0gsT0FBTyxDQUFDcEgsR0FBRyxJQUFJO01BQ2xCLE1BQU0ySCxHQUFHLEdBQUdoQyxPQUFPLENBQUNpQyxHQUFHLENBQUNDLE1BQU0sSUFBSTtRQUNoQyxNQUFNQyxLQUFLLEdBQUc5SCxHQUFHLENBQUM2SCxNQUFNLENBQUM7UUFDekIsSUFBSSxPQUFPQyxLQUFLLEtBQUssUUFBUSxFQUFFO1VBQzdCLE9BQU8sSUFBSWpDLElBQUksQ0FBQ0MsU0FBUyxDQUFDZ0MsS0FBSyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEdBQUc7UUFDekQ7UUFDQSxPQUFPLElBQUlDLE1BQU0sQ0FBQ0YsS0FBSyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEdBQUc7TUFDakQsQ0FBQyxDQUFDO01BQ0ZOLEdBQUcsQ0FBQ3pDLElBQUksQ0FBQzJDLEdBQUcsQ0FBQ0QsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3pCLENBQUMsQ0FBQztJQUVGLE9BQU9ELEdBQUcsQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQztFQUN2Qjs7RUFFQTtBQUNGO0FBQ0E7RUFDRU8sWUFBWUEsQ0FBQ0MsVUFBVSxHQUFHLEVBQUUsRUFBRTtJQUM1QixNQUFNQyxVQUFVLEdBQUcsSUFBSTlILElBQUksQ0FBQyxDQUFDO0lBQzdCOEgsVUFBVSxDQUFDQyxPQUFPLENBQUNELFVBQVUsQ0FBQ0UsT0FBTyxDQUFDLENBQUMsR0FBR0gsVUFBVSxDQUFDO0lBRXJELE1BQU1JLFdBQVcsR0FBRyxJQUFJLENBQUMxSSxJQUFJLENBQUNxRixNQUFNO0lBQ3BDLElBQUksQ0FBQ3JGLElBQUksR0FBRyxJQUFJLENBQUNBLElBQUksQ0FBQzRHLE1BQU0sQ0FBQ3hHLEdBQUcsSUFDOUIsSUFBSUssSUFBSSxDQUFDTCxHQUFHLENBQUNJLFNBQVMsQ0FBQyxHQUFHK0gsVUFDNUIsQ0FBQztJQUVELE9BQU87TUFDTEksV0FBVyxFQUFFRCxXQUFXLEdBQUcsSUFBSSxDQUFDMUksSUFBSSxDQUFDcUYsTUFBTTtNQUMzQ3VELGFBQWEsRUFBRSxJQUFJLENBQUM1SSxJQUFJLENBQUNxRjtJQUMzQixDQUFDO0VBQ0g7O0VBRUE7QUFDRjtBQUNBO0VBQ0V3RCxhQUFhQSxDQUFBLEVBQUc7SUFDZCxNQUFNQyxLQUFLLEdBQUc7TUFDWjFCLFNBQVMsRUFBRSxJQUFJLENBQUNwSCxJQUFJLENBQUNxRixNQUFNO01BQzNCMEQsUUFBUSxFQUFFLENBQUMsQ0FBQztNQUNaQyxZQUFZLEVBQUUsQ0FBQyxDQUFDO01BQ2hCQyxZQUFZLEVBQUUsQ0FBQyxDQUFDO01BQ2hCQyxTQUFTLEVBQUU7UUFDVEMsTUFBTSxFQUFFLElBQUksQ0FBQ25KLElBQUksQ0FBQ3FGLE1BQU0sR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDckYsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDUSxTQUFTLEdBQUcsSUFBSTtRQUM1RDRJLE1BQU0sRUFBRSxJQUFJLENBQUNwSixJQUFJLENBQUNxRixNQUFNLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQ3JGLElBQUksQ0FBQyxJQUFJLENBQUNBLElBQUksQ0FBQ3FGLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQzdFLFNBQVMsR0FBRztNQUM3RTtJQUNGLENBQUM7SUFFRCxJQUFJLENBQUNSLElBQUksQ0FBQ3dILE9BQU8sQ0FBQ3BILEdBQUcsSUFBSTtNQUN2QjBJLEtBQUssQ0FBQ0MsUUFBUSxDQUFDM0ksR0FBRyxDQUFDRyxJQUFJLENBQUMsR0FBRyxDQUFDdUksS0FBSyxDQUFDQyxRQUFRLENBQUMzSSxHQUFHLENBQUNHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO01BQzlEdUksS0FBSyxDQUFDRSxZQUFZLENBQUM1SSxHQUFHLENBQUNjLE1BQU0sQ0FBQyxHQUFHLENBQUM0SCxLQUFLLENBQUNFLFlBQVksQ0FBQzVJLEdBQUcsQ0FBQ2MsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7TUFFMUUsSUFBSWQsR0FBRyxDQUFDTyxNQUFNLEVBQUU7UUFDZG1JLEtBQUssQ0FBQ0csWUFBWSxDQUFDN0ksR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDbUksS0FBSyxDQUFDRyxZQUFZLENBQUM3SSxHQUFHLENBQUNPLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO01BQzVFO0lBQ0YsQ0FBQyxDQUFDO0lBRUYsT0FBT21JLEtBQUs7RUFDZDtBQUNGOztBQUVBO0FBQ0EsSUFBSSxPQUFPTyxNQUFNLEtBQUssV0FBVyxJQUFJQSxNQUFNLENBQUNDLE9BQU8sRUFBRTtFQUNuREQsTUFBTSxDQUFDQyxPQUFPLEdBQUd4SixXQUFXO0FBQzlCO0FBQUMsSUFBQXlKLFFBQUEsR0FBQUQsT0FBQSxDQUFBRSxPQUFBLEdBRWMxSixXQUFXIiwiaWdub3JlTGlzdCI6W119